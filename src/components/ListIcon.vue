<script lang="ts" setup>
  import { useMediaQuery } from "@vueuse/core";
  import { ref, watchEffect } from "vue";
  import Aside from "./Aside.vue";

  const open = ref(false);
  const query = useMediaQuery("(min-width: 1080px)");

  watchEffect(() => {
    if (query.value) {
      open.value = false;
    }
  });

  function onClick(event: Event) {
    if (
      open.value &&
      (event.target instanceof HTMLAnchorElement ||
        event.target instanceof HTMLButtonElement)
    ) {
      open.value = false;
    }
  }
</script>

<!-- https://www.svgrepo.com/svg/15213/list -->

<template>
  <svg
    v-if="!query"
    class="icon"
    viewBox="-4 0 64 64"
    xmlns="http://www.w3.org/2000/svg"
    @click="open = !open"
  >
    <path
      d="M22.9840508,12.7494497h40c0.5522995,0,0.9995995-0.4471998,0.9995995-0.9994993
    c0-0.5522003-0.4473-0.9995003-0.9995995-0.9995003h-40c-0.5522003,0-0.9995003,0.4473-0.9995003,0.9995003
    C21.9845505,12.3022499,22.4318504,12.7494497,22.9840508,12.7494497z"
    />

    <path
      d="M62.9840508,31.2963505h-40c-0.5522003,0-0.9995003,0.4473-0.9995003,0.9994984
    c0,0.5522995,0.4473,0.9995003,0.9995003,0.9995003h40c0.5522995,0,0.9995995-0.4472008,0.9995995-0.9995003
    C63.9836502,31.7436504,63.5363503,31.2963505,62.9840508,31.2963505z"
    />

    <path
      d="M62.9840508,51.2504501h-40c-0.5522003,0-0.9995003,0.4473-0.9995003,0.9995003
    c0,0.5522995,0.4473,0.9995003,0.9995003,0.9995003h40c0.5522995,0,0.9995995-0.4472008,0.9995995-0.9995003
    C63.9836502,51.6977501,63.5363503,51.2504501,62.9840508,51.2504501z"
    />

    <path
      d="M5.9840508,5.7822499c-3.2904999,0-5.9677,2.6771998-5.9677,5.9677005c0,3.2905998,2.6772001,5.9678001,5.9677,5.9678001
    c3.2905998,0,5.9678001-2.6772003,5.9678001-5.9678001C11.9518509,8.4594498,9.2746506,5.7822499,5.9840508,5.7822499z
     M5.9840508,15.7822504c-2.2235854,0-4.0321999-1.8086004-4.0321999-4.0323c0-2.2236004,1.8086146-4.0322003,4.0321999-4.0322003
    c2.2236996,0,4.0323,1.8085999,4.0323,4.0322003C10.0163507,13.97365,8.2077503,15.7822504,5.9840508,15.7822504z"
    />

    <path
      d="M5.9840508,26.3281498c-3.2904999,0-5.9677,2.6772003-5.9677,5.9676991c0,3.2905998,2.6772001,5.9678001,5.9677,5.9678001
    c3.2905998,0,5.9678001-2.6772003,5.9678001-5.9678001C11.9518509,29.0053501,9.2746506,26.3281498,5.9840508,26.3281498z
     M5.9840508,36.3281517c-2.2235854,0-4.0321999-1.8086014-4.0321999-4.0323029c0-2.2235985,1.8086146-4.032198,4.0321999-4.032198
    c2.2236996,0,4.0323,1.8085995,4.0323,4.032198C10.0163507,34.5195503,8.2077503,36.3281517,5.9840508,36.3281517z"
    />

    <path
      d="M5.9840508,46.2822495c-3.2904999,0-5.9677,2.6772003-5.9677,5.967701c0,3.2905998,2.6772001,5.9678001,5.9677,5.9678001
    c3.2905998,0,5.9678001-2.6772003,5.9678001-5.9678001C11.9518509,48.9594498,9.2746506,46.2822495,5.9840508,46.2822495z
     M5.9840508,56.2822495c-2.2235854,0-4.0321999-1.8085976-4.0321999-4.032299c0-2.2236023,1.8086146-4.0321999,4.0321999-4.0321999
    c2.2236996,0,4.0323,1.8085976,4.0323,4.0321999C10.0163507,54.4736519,8.2077503,56.2822495,5.9840508,56.2822495z"
    />
  </svg>

  <Teleport to="body">
    <Aside :open="open" @click="onClick">
      <slot />
    </Aside>
  </Teleport>
</template>

<style lang="scss" scoped>
  .icon {
    display: inline-block;
    margin-right: 4px !important;
    cursor: pointer;
    fill: currentColor;
    stroke: black;
    stroke-width: 2px;
    stroke-linecap: round;

    .dark & {
      stroke: white;
    }
  }
</style>

import{d as b,o as m,h as V,s as R,c as w,a as r,p as W,j as ee,b as _,as as ie,e as u,g as K,v as N,at as H,m as p,ad as Q,f as y,w as ue,i as j,q}from"./index.b4d39ce3.js";import{_ as x,B,H as te}from"./Modal.8561d395.js";import{F as re}from"./Field.01c52485.js";import{F as ce}from"./useWebGL.4c657e35.js";import{s as h,u as O,a as de}from"./useMovableCanvas.bd9f9b42.js";const pe=["value"],me=b({__name:"Dropdown",props:{modelValue:null},emits:["update:modelValue"],setup(e){return(o,l)=>(m(),V("select",{class:"field focusline second-layer",value:o.$props.modelValue,onChange:l[0]||(l[0]=t=>o.$emit("update:modelValue",t.target.value))},[R(o.$slots,"default",{},void 0,!0)],40,pe))}});var fe=x(me,[["__scopeId","data-v-7132250d"]]);const G=b({__name:"IconButton",setup(e){return(o,l)=>(m(),w(B,{center:"",style:{width:"2.5em",height:"2.25em"}},{default:r(()=>[R(o.$slots,"default")]),_:3}))}});const ve={},he=e=>(W("data-v-0298e8c4"),e=e(),ee(),e),_e={class:"icon",viewBox:"0 0 485.064 485.064",xmlns:"http://www.w3.org/2000/svg"},be=he(()=>_("path",{d:`M458.736,181.097H26.334C11.793,181.097,0,192.884,0,207.425v70.215c0,14.541,11.787,26.328,26.334,26.328h432.402\r
      c14.541,0,26.328-11.787,26.328-26.328v-70.215C485.07,192.884,473.283,181.097,458.736,181.097z`},null,-1)),ye=[be];function xe(e,o){return m(),V("svg",_e,ye)}var ze=x(ve,[["render",xe],["__scopeId","data-v-0298e8c4"]]);const Ve={},we=e=>(W("data-v-079820ed"),e=e(),ee(),e),ge={class:"icon",viewBox:"0 0 60.364 60.364",xmlns:"http://www.w3.org/2000/svg"},$e=we(()=>_("path",{d:`M54.454,23.18l-18.609-0.002L35.844,5.91C35.845,2.646,33.198,0,29.934,0c-3.263,0-5.909,2.646-5.909,5.91v17.269\r
		L5.91,23.178C2.646,23.179,0,25.825,0,29.088c0.002,3.264,2.646,5.909,5.91,5.909h18.115v19.457c0,3.267,2.646,5.91,5.91,5.91\r
		c3.264,0,5.909-2.646,5.91-5.908V34.997h18.611c3.262,0,5.908-2.645,5.908-5.907C60.367,25.824,57.718,23.178,54.454,23.18z`},null,-1)),ke=[$e];function Ie(e,o){return m(),V("svg",ge,ke)}var Ce=x(Ve,[["render",Ie],["__scopeId","data-v-079820ed"]]);const Se=["autocomplete","placeholder","type","value"],Fe=b({__name:"InlineField",props:{modelValue:null,type:null,autocomplete:null,placeholder:null},emits:["update:modelValue"],setup(e){return(o,l)=>{var t,a;return m(),V("input",{class:"field",autocomplete:(t=e.autocomplete)!=null?t:"off",placeholder:e.placeholder,style:ie({width:e.modelValue.length+2+"ch"}),type:(a=e.type)!=null?a:"text",value:e.modelValue,onInput:l[0]||(l[0]=s=>o.$emit("update:modelValue",s.target.value))},null,44,Se)}}});var Ue=x(Fe,[["__scopeId","data-v-3d0155ac"]]);const Le=b({__name:"InlineNumericField",props:{modelValue:null,autocomplete:null,placeholder:null},emits:["update:modelValue"],setup(e){return(o,l)=>(m(),w(Ue,{autocomplete:e.autocomplete,"model-value":""+e.modelValue,placeholder:e.placeholder,type:"number","onUpdate:modelValue":l[0]||(l[0]=t=>o.$emit("update:modelValue",+t))},null,8,["autocomplete","model-value","placeholder"]))}});const Pe=b({__name:"Incrementable",props:{modelValue:null,decrement:{type:Function,default:e=>e-1},increment:{type:Function,default:e=>e+1},label:null},emits:["update:modelValue"],setup(e){function o({target:l}){var t;(t=l.querySelector("input"))==null||t.focus()}return(l,t)=>(m(),w(te,null,{default:r(()=>[u(G,{onClick:t[0]||(t[0]=a=>l.$emit("update:modelValue",e.decrement(e.modelValue)))},{default:r(()=>[u(ze)]),_:1}),_("p",{class:"label",onClick:o},[K(N(e.label)+" ",1),u(Le,{"model-value":e.modelValue,"onUpdate:modelValue":t[1]||(t[1]=a=>l.$emit("update:modelValue",a))},null,8,["model-value"])]),u(G,{onClick:t[2]||(t[2]=a=>l.$emit("update:modelValue",e.increment(e.modelValue)))},{default:r(()=>[u(Ce)]),_:1})]),_:1}))}});var X=x(Pe,[["__scopeId","data-v-6b56d56b"]]);const Ee=["autocomplete","checked","type"],Me=b({__name:"InlineCheckboxField",props:{modelValue:{type:Boolean},type:null,autocomplete:null},emits:["update:modelValue"],setup(e){return(o,l)=>{var t,a;return m(),V("input",{class:"field",autocomplete:(t=e.autocomplete)!=null?t:"off",checked:e.modelValue,type:(a=e.type)!=null?a:"checkbox",onChange:l[0]||(l[0]=s=>o.$emit("update:modelValue",s.target.checked))},null,40,Ee)}}});var Y=x(Me,[["__scopeId","data-v-5a55106d"]]);const Oe=["autocomplete","max","min","step","value"],De=b({__name:"InlineRangeField",props:{modelValue:null,autocomplete:null,min:null,max:null,step:null},emits:["update:modelValue"],setup(e){return(o,l)=>{var t;return m(),V("input",{class:"field",autocomplete:(t=e.autocomplete)!=null?t:"off",max:e.max,min:e.min,step:e.step,value:e.modelValue,type:"range",onInput:l[0]||(l[0]=a=>o.$emit("update:modelValue",+a.target.value))},null,40,Oe)}}});var D=x(De,[["__scopeId","data-v-13b05489"]]);const Be={class:"label"},Re={class:"nowrap"},Ke=b({__name:"Labeled",props:{label:null},setup(e){return(o,l)=>(m(),V("label",Be,[u(te,null,{default:r(()=>[_("span",Re,N(e.label),1),R(o.$slots,"default",{},void 0,!0)]),_:3})]))}});var z=x(Ke,[["__scopeId","data-v-c154c8f4"]]);const Ne={"+":2,"-":2,"*":3,"#":3,"/":3,"**":4,"^":5};function Z(e){return e==="("?0:Ne[e]||1}const Te={"+":"l","-":"l","*":"l","#":"l","/":"l"};function Ae(e){return Te[e]||"r"}const He=["+","-","*","#","/","^","("];function J(e){return!He.includes(e)}function Qe(e){const o=[];let l=!1;for(;;){let i;if(e.length===0)break;(i=e.match(/^\d+(?:\.\d+)?/))?(l&&o.push("**"),l=!0,o.push(+i[0]),e=e.slice(i[0].length)):(i=e.match(/^(sin|cos|tan|exp|log|abs|min|max)/))?(l&&o.push("**"),l=!1,o.push(i[0]),e=e.slice(i[0].length)):(i=e.match(/^(pi|pz|ppz|sz|e|i|c|z|fx|fy)/))?(l&&o.push("**"),l=!0,o.push(i[0]),e=e.slice(i[0].length)):((i=e.match(/^[-+*#\/^()]/))&&(l&&i[0]==="("&&o.push("**"),l=!1,i[0]===")"&&(l=!0),o.push(i[0])),e=e.slice(1))}const t=[],a=[];let s;for(;s=o.shift();)if(typeof s=="number"||s.match(/^(pi|pz|ppz|sz|e|i|c|z|fx|fy)$/))t.push(s);else if(s===")"){for(;a[a.length-1]!=="(";){const f=a[a.length-1];if(!f)return["z"];a.pop(),t.push(f)}if(a.pop()!=="(")return["z"];const i=a[a.length-1];if(!i)continue;J(i)&&(a.pop(),t.push(i))}else if(s==="("||J(s))a.push(s);else{const i=s;let f;for(;(f=a[a.length-1])&&f!=="(";){const v=Z(i),g=Z(f);if(!(g>v||v===g&&Ae(i)==="l"))break;t.push((a.pop(),f))}a.push(i)}for(;s=a.pop();){if(s==="("||s===")")return["z"];t.push(s)}return t}function je(e){var o;try{const l=[];for(let t of e)if(typeof t=="number")l.push(`vec2(${t}, 0)`);else if(t==="i")l.push("vec2(0, 1)");else if(t==="pi")l.push("vec2(3.141592653589793, 0)");else if(t==="e")l.push("vec2(2.718281828459045, 0)");else if(t==="fx")l.push("vec2(1, -1)");else if(t==="fy")l.push("vec2(-1, 1)");else if(t.match(/^(pz|ppz|sz|c|z)$/))l.push(t);else if(t==="+"||t==="-"||t==="#"){const a=l.pop(),s=(o=l.pop())!=null?o:"";l.push(`${s} ${t==="#"?"*":t} ${a}`)}else if(t==="*"||t==="**"||t==="/"||t==="^"||t==="min"||t==="max"){t==="/"?t="div":t==="^"?t="power":(t==="*"||t==="**")&&(t="mult");const a=l.pop(),s=l.pop();l.push(`${t}(${s}, ${a})`)}else(t==="sin"||t==="cos"||t==="tan"||t==="exp"||t==="log"||t==="abs")&&l.push(`${t}(${l.pop()})`);return l.length!==1?"z":l[0]}catch{return"z"}}function le(e){return je(Qe(e))}Object.assign(window,{glsl:le});const qe=K("Apply Equation"),Ge=_("option",{value:"simple"},"Simple",-1),Xe=_("option",{value:"gradient"},"Gradient",-1),Ye=_("option",{value:"rotation"},"Rotation",-1),Ze=_("option",{value:"newton"},"Newton's Method",-1),Je=K(" Reset Position "),ot=b({__name:"FractalExplorer",setup(e){const o=H(100,5,1e3);h("detail",o);function l(n){return n<=10?5:n<=25?5*Math.ceil((n-5)/5):n<=50?25:50*Math.ceil((n-50)/50)}function t(n){return n<10?10:n<25?5*~~((n+5)/5):n<50?50:50*~~((n+50)/50)}const a=H(2,.1,1/0);h("limit",a);function s(n){return n<=2?Math.ceil(10*(n-.1))/10:Math.ceil(n-1)}function i(n){return n<2?~~(10*(n+.1))/10:~~(n+1)}const f=p("z^2+c");h("equation",f);const v=p("simple");h("theme",v);const g={simple:1,gradient:2,rotation:3,newton:4},ne=Q(()=>g[v.value]),$=p(0);h("colorOffset",$);const k=p(1);h("repetition",k);const I=p(1);h("spectrum",I);const C=p(!1);h("darkness",C);const S=p(!1);h("split",S);const oe="in vec2 pos;out vec4 color;uniform int detail;uniform float limit;uniform int theme;uniform float colorOffset;uniform float repetition;uniform float spectrum;uniform bool darkness;uniform bool split;float pi=3.1415926535;vec3 rgb2hsv(vec3 c){vec4 K=vec4(0.0,-1.0/3.0,2.0/3.0,-1.0);vec4 p=mix(vec4(c.bg,K.wz),vec4(c.gb,K.xy),step(c.b,c.g));vec4 q=mix(vec4(p.xyw,c.r),vec4(c.r,p.yzx),step(p.x,c.r));float d=q.x-min(q.w,q.y);float e=1.0e-10;return vec3(abs(q.z+(q.w-q.y)/(6.0*d+e)),d/(q.x+e),q.x);}vec3 hsv2rgb(vec3 c){vec4 K=vec4(1.0,2.0/3.0,1.0/3.0,3.0);vec3 p=abs(fract(c.xxx+K.xyz)*6.0-K.www);return c.z*mix(K.xxx,clamp(p-K.xxx,0.0,1.0),c.y);}vec3 simplePalette(int i){float hue=mod(0.02*repetition*float(i),1.0);vec3 hsv=vec3(1.0-hue*spectrum,1,1);if(darkness)hsv.z=mod(0.02*float(i),1.0);hsv.x=mod(hsv.x+colorOffset,1.0);return hsv2rgb(hsv);}vec3 gradientPalette(vec3 sz,int i){sz=abs(sz)/float(i)*repetition;vec3 hsv=rgb2hsv(sin(abs(sz*5.0))*0.45+0.5);vec3 rgb=hsv2rgb(vec3(hsv.x*spectrum+colorOffset,hsv.yz));if(darkness)rgb*=mod(float(i)*0.02,1.0);return rgb;}vec3 rotationPalette(float t,int i){float hue=mod(2.0*t/pi*repetition,1.0);vec3 rgb=hsv2rgb(vec3(1.0-hue*spectrum+colorOffset,1,1));if(darkness)rgb*=mod(float(i)*0.02,1.0);return rgb;}vec3 newtonPalette(float t){float hue=mod(t/pi*repetition,1.0)*spectrum;hue=mod(hue+colorOffset,1.0);return hsv2rgb(vec3(1.0-hue,1,1));}vec2 cube(vec2 a){float x2=a.x*a.x;float y2=a.y*a.y;float d=x2-y2;return vec2(a.x*(d-y2-y2),a.y*(d+x2+x2));}vec2 sqr(vec2 a){return vec2(a.x*a.x-a.y*a.y,2.0*a.x*a.y);}vec2 mult(vec2 a,vec2 b){float x=a.x*b.x-a.y*b.y;float y=a.x*b.y+a.y*b.x;return vec2(x,y);}vec2 div(vec2 a,vec2 b){float denom=1.0/(b.x*b.x+b.y*b.y);return vec2(a.x*b.x+a.y*b.y,a.y*b.x-a.x*b.y)*denom;}vec2 power(vec2 a,vec2 b){int count=int(b.x);if(count<=1)return a;vec2 result=a;for(int i=1;i<count;i++){result=mult(result,a);}return result;}void main(){vec2 pz,ppz,nz,c=pos,z;vec3 sz;if(theme==4||theme==1&&split)z=pos;int iter=0;for(int i=0;i<detail;i++){ppz=pz;pz=z;z={{EQ}};iter++;if(length(z)>limit){if(theme==1){color=vec4(simplePalette(iter),1);return;}else if(theme==2){color=vec4(gradientPalette(sz,iter),1);return;}else if(theme==3){color=vec4(rotationPalette(atan(sz.x,sz.y),iter),1);return;}}nz+=z;sz.x+=dot(z-pz,pz-ppz);sz.y+=dot(z-pz,z-pz);sz.z+=dot(z-ppz,z-ppz);if(split){sz+=sign(vec3(float(z),float(pz),float(ppz)));}if(theme==3&&!split){sz-=sign(vec3(float(z),float(pz),float(ppz)));}}if(theme==2){color=vec4(gradientPalette(sz,iter),1);}else if(theme==3){color=vec4(rotationPalette(pi-atan(sz.y/sz.x),detail),1);}else if(theme==4){if(darkness)z=nz;color=vec4(newtonPalette(atan(z.y/z.x)),1);}else color=vec4(0,0,0,1);}",F=p("zoomLevel");h("indicator",F);function ae(){F.value={zoomLevel:"position",position:"zoomLevel"}[F.value]||"position"}const L=O(p(1),100),P=O(p(0)),E=O(p(0)),se=Q(()=>(y(P),y(E),y(L),F.value==="position"?`Position: (${P.value}, ${E.value})`:`Zoom Level: ${L.value.toLocaleString()}`)),T=p();let U,M=p();function A(){U==null||U(),de(T,oe.replace("{{EQ}}",le(f.value))).then(n=>{n.useUniform("detail","i",o),n.useUniform("limit","f",a),n.useUniform("theme","i",ne),n.useUniform("colorOffset","f",$),n.useUniform("repetition","f",k),n.useUniform("spectrum","f",I),n.useUniform("darkness","f",C),n.useUniform("split","f",S),n.onDispose(ue(()=>{L.value=4/(n.bounds.xEnd.value-n.bounds.xStart.value),P.value=(n.bounds.xEnd.value+n.bounds.xStart.value)/2,E.value=(n.bounds.yEnd.value+n.bounds.yStart.value)/2})),M.value=()=>{n.bounds.xStart.value=-2,n.bounds.xEnd.value=2,n.bounds.yStart.value=-2,n.bounds.yEnd.value=2},U=n.destroy})}return A(),(n,c)=>(m(),w(ce,null,{options:r(()=>[u(X,{modelValue:y(o),"onUpdate:modelValue":c[0]||(c[0]=d=>j(o)?o.value=d:null),decrement:l,increment:t,label:"Detail Level:"},null,8,["modelValue"]),u(X,{modelValue:y(a),"onUpdate:modelValue":c[1]||(c[1]=d=>j(a)?a.value=d:null),decrement:s,increment:i,label:"Fractal Size:"},null,8,["modelValue"]),u(z,{label:"Equation:"},{default:r(()=>[u(re,{modelValue:f.value,"onUpdate:modelValue":c[2]||(c[2]=d=>f.value=d)},null,8,["modelValue"]),u(B,{style:{"white-space":"pre"},onClick:A},{default:r(()=>[qe]),_:1})]),_:1}),u(z,{label:"Theme:"},{default:r(()=>[u(fe,{modelValue:v.value,"onUpdate:modelValue":c[3]||(c[3]=d=>v.value=d)},{default:r(()=>[Ge,Xe,Ye,Ze]),_:1},8,["modelValue"])]),_:1}),u(z,{label:"Color Offset:"},{default:r(()=>[u(D,{modelValue:$.value,"onUpdate:modelValue":c[4]||(c[4]=d=>$.value=d),max:1,min:0,step:"any"},null,8,["modelValue"])]),_:1}),u(z,{label:"Color Repetition:"},{default:r(()=>[u(D,{modelValue:k.value,"onUpdate:modelValue":c[5]||(c[5]=d=>k.value=d),max:10,min:0,step:"any"},null,8,["modelValue"])]),_:1}),u(z,{label:"Color Spectrum:"},{default:r(()=>[u(D,{modelValue:I.value,"onUpdate:modelValue":c[6]||(c[6]=d=>I.value=d),max:1,min:0,step:"any"},null,8,["modelValue"])]),_:1}),u(z,{label:v.value==="newton"?"3D Effect?":"Darkness Effect?"},{default:r(()=>[u(Y,{modelValue:C.value,"onUpdate:modelValue":c[7]||(c[7]=d=>C.value=d)},null,8,["modelValue"])]),_:1},8,["label"]),v.value!=="newton"?(m(),w(z,{key:0,label:v.value==="simple"?"Mimic Newton's Method?":v.value==="rotation"?"Alternate Split?":"Split Effect?"},{default:r(()=>[u(Y,{modelValue:S.value,"onUpdate:modelValue":c[8]||(c[8]=d=>S.value=d)},null,8,["modelValue"])]),_:1},8,["label"])):q("",!0)]),buttons:r(()=>[y(M)?(m(),w(B,{key:0,onClick:y(M)},{default:r(()=>[Je]),_:1},8,["onClick"])):q("",!0)]),indicator:r(()=>[_("div",{style:{cursor:"pointer"},onClick:ae},N(y(se)),1)]),default:r(()=>[_("canvas",{ref_key:"canvas",ref:T},null,512)]),_:1}))}});export{ot as default};

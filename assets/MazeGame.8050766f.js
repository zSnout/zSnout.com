import{d as F,k as O,ad as G,a7 as W,A as T,a0 as H,o as L,c as X,w as N,a as E}from"./index.b28acfcf.js";import{F as V}from"./FullscreenDisplay.e56ee7f0.js";import{u as D}from"./useCanvas.6f974610.js";import{_ as q}from"./BookmarkIcon.90b7aed7.js";function R(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);r&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function C(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?R(Object(n),!0).forEach(function(o){J(t,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(n,o))})}return t}function J(t,r,n){return r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function I(t){return t.slice(0,-1)}function B(t,r=0){return r?Array.from(Array(r-t).keys()).map(n=>n+t):Array.from(Array(t).keys())}function Y(t){return[...new Set(t)]}function S(t,r){const n=Y(t.map(p=>p.set)).filter(Boolean),o=(e=B(1,t.length+1),m=n,[e,m].reduce((p,b)=>p.filter(_=>!b.includes(_)))).sort(()=>.5-r());var e,m;t.filter(p=>!p.set).forEach((p,b)=>p.set=o[b])}function A(t,r,n=.5){I(t).forEach((o,e)=>{const m=t[e+1],p=o.set!==m.set,b=r()<=n;p&&b&&(function(_,f,s){_.forEach(d=>{d.set===f&&(d.set=s)})}(t,m.set,o.set),o.right=!1,m.left=!1)})}function K(t=8,r=t,n=!0,o=1){const e=function(f){return function(){let s=f+=1831565813;return s=Math.imul(s^s>>>15,1|s),s^=s+Math.imul(s^s>>>7,61|s),((s^s>>>14)>>>0)/4294967296}}(o),m=[],p=B(t);for(let f=0;f<r;f+=1){const s=p.map(d=>({x:d,y:f,top:n||f>0,left:n||d>0,bottom:n||f<r-1,right:n||d<t-1}));m.push(s)}I(m).forEach((f,s)=>{S(f,e),A(f,e),function(d,z,k){const P=Object.values(function(g,v){let c=Y(g.map(u=>u.set)).reduce((u,i)=>C(C({},u),{},{[i]:[]}),{});return g.forEach(u=>c[u.set].push(u)),c}(d)),{ceil:j}=Math;P.forEach(g=>{(function(v,c,u){c=c==null?1:c;const i=v==null?0:v.length;if(!i||c<1)return[];c=c>i?i:c;let w=-1;const a=i-1,y=[...v];for(;++w<c;){const h=w+Math.floor(u()*(a-w+1)),l=y[h];y[h]=y[w],y[w]=l}return y.slice(0,c)})(g,j(k()*g.length),k).forEach(v=>{if(v){const c=z[v.x];v.bottom=!1,c.top=!1,c.set=v.set}})})}(f,m[s+1],e)});const b=(_=m)[_.length-1];var _;return S(b,e),A(b,e,1),m}const Q=F({__name:"MazeGame",setup(t){const r=O(),n=O(),o=O(),e=32,m=12,p=e/2,b=e/4;let _=0,f=0;const s=O(0),d=O(0),{beta:z,gamma:k}=G(),{x:P,y:j}=W(),g=T(()=>{var u;return(u=z.value)!=null?u:180*P.value/innerWidth-90}),v=T(()=>{var u;return(u=k.value)!=null?u:180*j.value/innerWidth-90}),c=T(()=>g.value<-30&&g.value<-Math.abs(v.value)?"right":g.value>30&&g.value>Math.abs(v.value)?"left":v.value<-30&&v.value<-Math.abs(g.value)?"down":v.value>30&&v.value>Math.abs(g.value)?"up":"none");return D(r,{useDevicePixelRatio:!1}).then(u=>{const{canvas:i,onResize:w}=u,a=i.getContext("2d");if(!a)throw new Error("Your device does not support HTML5 canvases.");function y(){if(!o.value&&i.width>4*e&&i.height>4*e){const h=~~(i.width/e)-2,l=~~(i.height/e)-2;o.value=K(h,l,!0,~~(Math.random()*1e6)),_=h,f=l}}y(),o.value||w(y),H(()=>{a.clearRect(0,0,i.width,i.height),a.beginPath();let h=s.value*e+e+p,l=d.value*e+e+p;h+=c.value==="left"?-b:c.value==="right"?b:0,l+=c.value==="up"?-b:c.value==="down"?b:0,a.fillStyle="black",a.moveTo(h,l),a.arc(h,l,m,0,2*Math.PI),a.fill()}),setInterval(()=>{var x;if(!o.value)return;const h=c.value,l=(x=o.value)==null?void 0:x[d.value][s.value];s.value+=h==="left"&&!l.left?-1:h==="right"&&!l.right?1:0,d.value+=h==="up"&&!l.top?-1:h==="down"&&!l.bottom?1:0,s.value=Math.max(0,Math.min(_,s.value)),d.value=Math.max(0,Math.min(f,d.value))},1e3)}),D(n,{useDevicePixelRatio:!1}).then(u=>{const{canvas:i,onResize:w}=u,a=i.getContext("2d");if(!a)throw new Error("Your device does not support HTML5 canvases.");function y(){if(a.fillStyle="white",a.fillRect(0,0,i.width,i.height),!!o.value)for(const h of o.value)for(const l of h){a.lineWidth=2,a.strokeStyle="black",a.lineCap="round";const x=l.x*e+e,M=l.y*e+e;l.top&&(a.moveTo(x,M),a.lineTo(x+e,M),a.stroke()),l.left&&(a.moveTo(x,M),a.lineTo(x,M+e),a.stroke()),l.right&&(a.moveTo(x+e,M),a.lineTo(x+e,M+e),a.stroke()),l.bottom&&(a.moveTo(x,M+e),a.lineTo(x+e,M+e),a.stroke())}}y(),w(()=>setTimeout(y,100))}),(u,i)=>(L(),X(V,null,{default:N(()=>[E("canvas",{ref_key:"mazeImage",ref:n,class:"maze-image"},null,512),E("canvas",{ref_key:"canvas",ref:r,class:"main"},null,512)]),_:1}))}});var te=q(Q,[["__scopeId","data-v-49db46d0"]]);export{te as default};

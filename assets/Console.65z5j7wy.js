import{w as B,a as V}from"./_plugin-vue_export-helper.4yxwi37t.js";import{b as D}from"./main.200onzgm.js";import{B as E,V as N}from"./VStack.3evi6szx.js";import{D as I}from"./Dropdown.5phpgqpn.js";import{F as x}from"./Field.5c7fkv56.js";import{H as F}from"./BookmarkIcon.46krkaf8.js";import{L as K}from"./Labeled.59ihovi6.js";import{l as k,x as r,C as g,D as f,z as S,r as y,o as L,y as c,h as T,ag as C,G as _,F as m,I as b,A as w,u as $,a8 as M,H as A,ac as H,ad as U}from"./runtime-core.esm-bundler.55v0mz3f.js";const j=k({__name:"MaybeLabeled",props:{label:null},setup(n){return(l,a)=>n.label?(r(),g(K,{key:0,label:n.label},{default:f(()=>[S(l.$slots,"default")]),_:3},8,["label"])):S(l.$slots,"default",{key:1})}}),z=k({__name:"Node",props:{node:null},setup(n){const{node:l}=n,a=y();return L(()=>{var u;(u=a.value)==null||u.replaceWith(l)}),(u,d)=>(r(),c("div",{ref_key:"el",ref:a},null,512))}}),q=n=>(H("data-v-3536536f"),n=n(),U(),n),G=q(()=>M("option",{disabled:"",value:""},"Choose an option...",-1)),O=["value"],W={key:1,class:"log"},J={key:2,class:"log"},Q={key:3,class:"log"},R=["onSubmit"];function ne(){const n={...globalThis.console,bindKey(t,e){n.focus(),p.push((s,o)=>(t===s&&(o(),e()),!0))},clear(){l.splice(0,l.length)},error(t,...e){l.push({type:"error",id:Math.random(),content:e.length?[t,...e]:t})},focus(){var t;(t=l.focus)==null||t.call(l)},key(t){return new Promise(e=>{n.focus(),p.push((s,o)=>{if(t===s){o(),e();return}return!0})})},line(){l.push({type:"line",id:Math.random()})},log(t,...e){l.push({type:"log",id:Math.random(),content:e.length?[t,...e]:t})},prompt(t,e){return a.value=t,n.focus(),new Promise(s=>{e?i.push(o=>{if(o)a.value="",s(o);else return!0}):i.push(o=>{a.value="",s(o)})})},select(t,e){const s=Math.random();return l.push({id:s,label:t,options:e,type:"select"}),setTimeout(n.focus),new Promise(o=>{d[s]=o})},user(t,...e){l.push({type:"user",id:Math.random(),content:e.length?[t,...e]:t})},warn(t,...e){l.push({type:"warn",id:Math.random(),content:e.length?[t,...e]:t})}},l=T([]),a=y(""),u=y(""),d=Object.create(null),i=[],p=[];return{console:n,field:u,messages:l,placeholder:a,onKey(t,e){p.splice(0,p.length,...p.filter(s=>s(t,e)))},onSelect(t,e){var s;(s=d[t])==null||s.call(d,e),delete d[t]},onSubmit(t){i.splice(0,i.length,...i.filter(e=>e(t)))}}}const X=k({__name:"Console",props:{field:null,messages:null,placeholder:null,stretch:{type:Boolean}},emits:["key","select","submit","update:field","update:messages"],setup(n,{emit:l}){const a=n;function u(){if(a.field){const e={type:"user",id:Math.random(),content:a.field};l("update:messages",a.messages.concat(e))}l("update:field",""),l("submit",a.field?a.field:void 0)}function d(e){let s=!1;l("key","Enter",()=>s=!0),s?e.preventDefault():u()}const i=y();a.messages.focus=()=>{var e,s;(s=(e=D(i))==null?void 0:e.querySelector("select:not([disabled]), input"))==null||s.focus()};const p=a.messages,t=e=>e instanceof globalThis.Node;return(e,s)=>(r(),g(N,{ref_key:"consoleEl",ref:i,class:w([{stretch:n.stretch},"console"])},{default:f(()=>[(r(!0),c(_,null,C($(p),o=>(r(),c(_,{key:o.id},[o.type==="select"?(r(),g(j,{key:0,class:"log",label:o.label,style:{"margin-bottom":"0.25em"}},{default:f(()=>[m(I,{class:"select",disabled:!!o.selected,"model-value":o.selected||"","onUpdate:modelValue":h=>h&&(o.selected=h)&&e.$emit("select",o.id,h)},{default:f(()=>[G,(r(!0),c(_,null,C(o.options,(h,v)=>(r(),c("option",{key:v,value:v},b(h),9,O))),128))]),_:2},1032,["disabled","model-value","onUpdate:modelValue"])]),_:2},1032,["label"])):o.type==="line"?(r(),c("hr",W)):Array.isArray(o.content)?(r(),c("p",J,b(o.content.join(" ")),1)):t(o.content)?(r(),c("p",Q,[m(z,{node:o.content},null,8,["node"])])):(r(),c("p",{key:4,class:w([o.type,"log"])},b(o.content),3))],64))),128)),M("form",{class:"form",style:{"margin-top":"auto"},onSubmit:B(u,["prevent"])},[m(F,{space:.75},{default:f(()=>[m(x,{ref:"fieldEl",class:"field","model-value":n.field?n.field:"",placeholder:n.placeholder,onKeydown:s[0]||(s[0]=o=>e.$emit("key",o.key,()=>o.preventDefault())),"onUpdate:modelValue":s[1]||(s[1]=o=>e.$emit("update:field",o))},null,8,["model-value","placeholder"]),m(E,{onClick:d},{default:f(()=>[A("âœ”")]),_:1})]),_:1},8,["space"])],40,R)]),_:1},8,["class"]))}});const ae=V(X,[["__scopeId","data-v-3536536f"]]);export{ae as C,ne as u};

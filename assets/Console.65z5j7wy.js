import{d as k,o as r,c as g,w as f,s as S,r as _,j as B,f as d,x as V,a9 as E,v as w,F as y,e as m,t as b,y as C,u as N,a as M,b as D,at as F,p as I,h as K,_ as L}from"./index.xh0zaea0.js";import{B as T,V as $}from"./VStack.3evi6szx.js";import{D as j}from"./Dropdown.5phpgqpn.js";import{F as U}from"./Field.5c7fkv56.js";import{H as A}from"./BookmarkIcon.1ijfs95x.js";import{L as H}from"./Labeled.59ihovi6.js";const q=k({__name:"MaybeLabeled",props:{label:{}},setup(a){return(l,n)=>l.label?(r(),g(H,{key:0,label:l.label},{default:f(()=>[S(l.$slots,"default")]),_:3},8,["label"])):S(l.$slots,"default",{key:1})}}),z=k({__name:"Node",props:{node:{}},setup(a){const{node:l}=a,n=_();return B(()=>{var u;(u=n.value)==null||u.replaceWith(l)}),(u,c)=>(r(),d("div",{ref_key:"el",ref:n},null,512))}}),O=a=>(I("data-v-3536536f"),a=a(),K(),a),W=O(()=>M("option",{disabled:"",value:""},"Choose an option...",-1)),G=["value"],J={key:1,class:"log"},Q={key:2,class:"log"},R={key:3,class:"log"},X=["onSubmit"];function se(){const a={...globalThis.console,bindKey(t,e){a.focus(),i.push((s,o)=>(t===s&&(o(),e()),!0))},clear(){l.splice(0,l.length)},error(t,...e){l.push({type:"error",id:Math.random(),content:e.length?[t,...e]:t})},focus(){var t;(t=l.focus)==null||t.call(l)},key(t){return new Promise(e=>{a.focus(),i.push((s,o)=>{if(t===s){o(),e();return}return!0})})},line(){l.push({type:"line",id:Math.random()})},log(t,...e){l.push({type:"log",id:Math.random(),content:e.length?[t,...e]:t})},prompt(t,e){return n.value=t,a.focus(),new Promise(s=>{e?p.push(o=>{if(o)n.value="",s(o);else return!0}):p.push(o=>{n.value="",s(o)})})},select(t,e){const s=Math.random();return l.push({id:s,label:t,options:e,type:"select"}),setTimeout(a.focus),new Promise(o=>{c[s]=o})},user(t,...e){l.push({type:"user",id:Math.random(),content:e.length?[t,...e]:t})},warn(t,...e){l.push({type:"warn",id:Math.random(),content:e.length?[t,...e]:t})}},l=V([]),n=_(""),u=_(""),c=Object.create(null),p=[],i=[];return{console:a,field:u,messages:l,placeholder:n,onKey(t,e){i.splice(0,i.length,...i.filter(s=>s(t,e)))},onSelect(t,e){var s;(s=c[t])==null||s.call(c,e),delete c[t]},onSubmit(t){p.splice(0,p.length,...p.filter(e=>e(t)))}}}const Y=k({__name:"Console",props:{field:{},messages:{},placeholder:{},stretch:{type:Boolean}},emits:["key","select","submit","update:field","update:messages"],setup(a,{emit:l}){const n=a;function u(){if(n.field){const e={type:"user",id:Math.random(),content:n.field};l("update:messages",n.messages.concat(e))}l("update:field",""),l("submit",n.field?n.field:void 0)}function c(e){let s=!1;l("key","Enter",()=>s=!0),s?e.preventDefault():u()}const p=_();n.messages.focus=()=>{var e,s;(s=(e=E(p))==null?void 0:e.querySelector("select:not([disabled]), input"))==null||s.focus()};const i=n.messages,t=e=>e instanceof globalThis.Node;return(e,s)=>(r(),g($,{ref_key:"consoleEl",ref:p,class:C([{stretch:e.stretch},"console"])},{default:f(()=>[(r(!0),d(y,null,w(N(i),o=>(r(),d(y,{key:o.id},[o.type==="select"?(r(),g(q,{key:0,class:"log",label:o.label,style:{"margin-bottom":"0.25em"}},{default:f(()=>[m(j,{class:"select",disabled:!!o.selected,"model-value":o.selected||"","onUpdate:modelValue":h=>h&&(o.selected=h)&&e.$emit("select",o.id,h)},{default:f(()=>[W,(r(!0),d(y,null,w(o.options,(h,v)=>(r(),d("option",{key:v,value:v},b(h),9,G))),128))]),_:2},1032,["disabled","model-value","onUpdate:modelValue"])]),_:2},1032,["label"])):o.type==="line"?(r(),d("hr",J)):Array.isArray(o.content)?(r(),d("p",Q,b(o.content.join(" ")),1)):t(o.content)?(r(),d("p",R,[m(z,{node:o.content},null,8,["node"])])):(r(),d("p",{key:4,class:C([o.type,"log"])},b(o.content),3))],64))),128)),M("form",{class:"form",style:{"margin-top":"auto"},onSubmit:F(u,["prevent"])},[m(A,{space:.75},{default:f(()=>[m(U,{ref:"fieldEl",class:"field","model-value":e.field?e.field:"",placeholder:e.placeholder,onKeydown:s[0]||(s[0]=o=>e.$emit("key",o.key,()=>o.preventDefault())),"onUpdate:modelValue":s[1]||(s[1]=o=>e.$emit("update:field",o))},null,8,["model-value","placeholder"]),m(T,{onClick:c},{default:f(()=>[D("âœ”")]),_:1})]),_:1})],40,X)]),_:1},8,["class"]))}});const le=L(Y,[["__scopeId","data-v-3536536f"]]);export{le as C,se as u};

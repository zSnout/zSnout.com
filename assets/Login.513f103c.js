import{a as y,B as v,V as w}from"./Modal.9c2abee5.js";import{D as b}from"./DocumentDisplay.36b6708d.js";import{F as p}from"./Field.fe9ca36f.js";import{L as m}from"./Labeled.a4e0e086.js";import{d as V,k as i,c as _,w as d,o as c,a as x,b as s,f as E,t as g,m as h,e as k,aC as B,aB as N,aD as S}from"./index.09ff9e18.js";async function C(o){try{const r=await(await fetch(`/api/${o.api}`,{method:o.method,body:o.body&&JSON.stringify(o.body),headers:o.body?{"content-type":"application/json"}:void 0})).text();try{const e=JSON.parse(r);if(typeof e!="object")return new Error("Expected a JSON object as a response.");for(const n of o.resultKeys)if(typeof e[n]!="string")return new Error(`Expected '${n}' to be a string.`);return e}catch{return new Error(r)}}catch(a){return a instanceof Error?a:new Error(""+a)}}const D={style:{"min-width":"min(500px, 100%)"}},$=k("Log In"),j={key:0},P=V({__name:"Login",setup(o){const a=i(""),r=i(""),e=i(""),n=i(!1);async function f(){n.value=!0;const l=await C({api:"account",method:"POST",body:{username:a.value,password:r.value},resultKeys:["session","username"]});l instanceof Error?e.value=l.message:(B.value=l.session,N.value=l.username,S.replace("/")),n.value=!1}return(l,t)=>(c(),_(b,{center:""},{default:d(()=>[x("form",D,[s(w,null,{default:d(()=>[s(m,{label:"Username"},{default:d(()=>[s(p,{modelValue:a.value,"onUpdate:modelValue":t[0]||(t[0]=u=>a.value=u),autocomplete:"username",maxlength:"32",placeholder:"Username...",onInput:t[1]||(t[1]=u=>e.value="")},null,8,["modelValue"])]),_:1}),s(m,{label:"Password"},{default:d(()=>[s(p,{modelValue:r.value,"onUpdate:modelValue":t[2]||(t[2]=u=>r.value=u),autocomplete:"password",placeholder:"Password...",type:"password",onInput:t[3]||(t[3]=u=>e.value="")},null,8,["modelValue"])]),_:1}),s(y,{size:2}),s(v,{onClick:f},{default:d(()=>[$]),_:1}),e.value?(c(),E("p",j,"Error: "+g(e.value),1)):h("",!0)]),_:1})])]),_:1}))}});export{P as default};

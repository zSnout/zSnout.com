import{u as R,a as j}from"./useVideoFromStream.4fd3547a.js";import{u as E}from"./useCanvas.7cddf4b3.js";import{d as L,s as g,aX as O,o as T,c as U,w,a as x}from"./index.e9cc25ec.js";import{F as V}from"./FullscreenDisplay.e4ced142.js";import"./SharedNav.57e661d0.js";import"./VStack.7090fa40.js";function X(r){const o=document.createElement("canvas"),h=o.getContext("2d");return{canvas:o,ctx:h,update:(n=r.videoWidth,c=r.videoHeight)=>{o.width=n,o.height=c,h.drawImage(r,0,0,n,c)}}}const Q=L({__name:"ascii-art",setup(r){const n="$@B%8&WM#*oahkbdpqwmZO0QLCJUYXzcvunxrjft/\\|()1{}[]?-_+~<>i!lI;:,\"^`'.  ",c=g(),l=g("user"),{stream:u,setOpts:b}=R({audio:!1,video:{facingMode:{ideal:l.value}}});function M(){l.value=l.value==="user"?"environment":"user",b({audio:!1,video:{facingMode:{ideal:l.value}}})}const z=j(u,!0),{ctx:d,update:_}=X(z);return E(c,{useDevicePixelRatio:!1}).then(m=>{const{canvas:i}=m,a=i.getContext("2d");if(!a)throw new Error("Your device doesn't support HTML5 canvases.");O(()=>{if(!u.value)return;_(~~(i.width/7.5),~~(i.height/9));const t=d.getImageData(0,0,d.canvas.width,d.canvas.height);a.beginPath(),a.fillStyle="black",a.fillRect(0,0,i.width,i.height);for(let e=0;e<t.height;e++)for(let s=0;s<t.width;s++){const[f,v,p]=t.data.subarray(4*(e*t.width+s),4*(e*t.width+s)+3),[C,y,H]=t.data.subarray(4*(e*t.width+Math.max(0,s-1)),4*(e*t.width+Math.max(0,s-1))+3),[k,W,B]=t.data.subarray(4*(Math.max(0,e-1)*t.width+s),4*(Math.max(0,e-1)*t.width+s)+3),F=(Math.abs(f-C)+Math.abs(f-k))/2,S=(Math.abs(v-y)+Math.abs(v-W))/2,D=(Math.abs(p-H)+Math.abs(p-B))/2,I=.2126*F+.7152*S+.0722*D,P=n[n.length-1-~~(I*n.length/256)];a.beginPath(),a.fillStyle="white",a.font=`${9}px monospace`,a.textAlign="center",a.textBaseline="middle",a.fillText(P,s*7.5+7.5/2,e*9+9/2)}})}),(m,i)=>(T(),U(V,null,{indicator:w(()=>[x("span",{style:{cursor:"pointer"},onClick:M},"Switch Camera")]),default:w(()=>[x("canvas",{ref_key:"canvas",ref:c},null,512)]),_:1}))}});export{Q as default};

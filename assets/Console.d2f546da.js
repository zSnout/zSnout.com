import{d as v,o as r,c as _,w as p,n as w,k as m,I as V,f as d,Q as B,O as S,r as E,l as C,u as N,F as g,a as M,b,q as x,e as D,t as y,p as I,g as F}from"./index.d2bfa997.js";import{V as K,F as L,b as T,H as $,_ as U}from"./BookmarkIcon.89c237e3.js";import{D as j}from"./Dropdown.39c07b93.js";import{L as q}from"./Labeled.76d95896.js";const A=v({__name:"MaybeLabeled",props:{label:null},setup(n){return(s,a)=>n.label?(r(),_(q,{key:0,label:n.label},{default:p(()=>[w(s.$slots,"default")]),_:3},8,["label"])):w(s.$slots,"default",{key:1})}}),H=v({__name:"Node",props:{node:null},setup(n){const{node:s}=n,a=m();return V(()=>{var c;(c=a.value)==null||c.replaceWith(s)}),(c,u)=>(r(),d("div",{ref_key:"el",ref:a},null,512))}});const O=n=>(I("data-v-2f2b0038"),n=n(),F(),n),z=O(()=>M("option",{disabled:"",value:""},"Choose an option...",-1)),Q=["value"],W={key:1,class:"log"},G={key:2,class:"log"},J={key:3,class:"log"},R=["onSubmit"],X=D("\u2714");function oe(){const n={...globalThis.console,bindKey(t,e){n.focus(),f.push((l,o)=>(t===l&&(o(),e()),!0))},clear(){s.splice(0,s.length)},error(t,...e){s.push({type:"error",id:Math.random(),content:e.length?[t,...e]:t})},focus(){var t;(t=s.focus)==null||t.call(s)},key(t){return new Promise(e=>{n.focus(),f.push((l,o)=>{if(t===l){o(),e();return}return!0})})},line(){s.push({type:"line",id:Math.random()})},log(t,...e){s.push({type:"log",id:Math.random(),content:e.length?[t,...e]:t})},prompt(t,e){return a.value=t,n.focus(),new Promise(l=>{e?i.push(o=>{if(o)a.value="",l(o);else return!0}):i.push(o=>{a.value="",l(o)})})},select(t,e){const l=Math.random();return s.push({id:l,label:t,options:e,type:"select"}),setTimeout(n.focus),new Promise(o=>{u[l]=o})},user(t,...e){s.push({type:"user",id:Math.random(),content:e.length?[t,...e]:t})},warn(t,...e){s.push({type:"warn",id:Math.random(),content:e.length?[t,...e]:t})}},s=E([]),a=m(""),c=m(""),u=Object.create(null),i=[],f=[];return{console:n,field:c,messages:s,placeholder:a,onKey(t,e){f.splice(0,f.length,...f.filter(l=>l(t,e)))},onSelect(t,e){var l;(l=u[t])==null||l.call(u,e),delete u[t]},onSubmit(t){i.splice(0,i.length,...i.filter(e=>e(t)))}}}const Y=v({__name:"Console",props:{field:null,messages:null,placeholder:null,stretch:{type:Boolean}},emits:["key","select","submit","update:field","update:messages"],setup(n,{emit:s}){const a=n;function c(){if(a.field){const e={type:"user",id:Math.random(),content:a.field};s("update:messages",a.messages.concat(e))}s("update:field",""),s("submit",a.field?a.field:void 0)}function u(e){let l=!1;s("key","Enter",()=>l=!0),l?e.preventDefault():c()}const i=m();a.messages.focus=()=>{var e,l;(l=(e=B(i))==null?void 0:e.querySelector("select:not([disabled]), input"))==null||l.focus()};const f=a.messages,t=e=>e instanceof globalThis.Node;return(e,l)=>(r(),_(K,{ref_key:"consoleEl",ref:i,class:S([{stretch:n.stretch},"console"])},{default:p(()=>[(r(!0),d(g,null,C(N(f),o=>(r(),d(g,{key:o.id},[o.type==="select"?(r(),_(A,{key:0,class:"log",label:o.label,style:{"margin-bottom":"0.25em"}},{default:p(()=>[b(j,{class:"select",disabled:!!o.selected,"model-value":o.selected||"","onUpdate:modelValue":h=>h&&(o.selected=h)&&e.$emit("select",o.id,h)},{default:p(()=>[z,(r(!0),d(g,null,C(o.options,(h,k)=>(r(),d("option",{key:k,value:k},y(h),9,Q))),128))]),_:2},1032,["disabled","model-value","onUpdate:modelValue"])]),_:2},1032,["label"])):o.type==="line"?(r(),d("hr",W)):Array.isArray(o.content)?(r(),d("p",G,y(o.content.join(" ")),1)):t(o.content)?(r(),d("p",J,[b(H,{node:o.content},null,8,["node"])])):(r(),d("p",{key:4,class:S([o.type,"log"])},y(o.content),3))],64))),128)),M("form",{class:"form",style:{"margin-top":"auto"},onSubmit:x(c,["prevent"])},[b($,{space:.75},{default:p(()=>[b(L,{ref:"fieldEl",class:"field","model-value":n.field?n.field:"",placeholder:n.placeholder,onKeydown:l[0]||(l[0]=o=>e.$emit("key",o.key,()=>o.preventDefault())),"onUpdate:modelValue":l[1]||(l[1]=o=>e.$emit("update:field",o))},null,8,["model-value","placeholder"]),b(T,{onClick:u},{default:p(()=>[X]),_:1})]),_:1},8,["space"])],40,R)]),_:1},8,["class"]))}});var le=U(Y,[["__scopeId","data-v-2f2b0038"]]);export{le as C,oe as u};

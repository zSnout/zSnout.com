import{d as v,o as r,c as _,w as p,m as w,s as b,aL as B,f as d,ax as V,k as S,u as x,F as g,a as M,b as m,n as E,at as C,e as N,r as D,t as y,p as L,g as F}from"./index.b536fd91.js";import{B as I,V as K,_ as T}from"./VStack.258b179b.js";import{D as $}from"./Dropdown.bc0f4c01.js";import{F as U,H as j}from"./SharedNav.2c352519.js";import{L as A}from"./Labeled.63fd54c7.js";const H=v({__name:"MaybeLabeled",props:{label:null},setup(n){return(s,a)=>n.label?(r(),_(A,{key:0,label:n.label},{default:p(()=>[w(s.$slots,"default")]),_:3},8,["label"])):w(s.$slots,"default",{key:1})}}),q=v({__name:"Node",props:{node:null},setup(n){const{node:s}=n,a=b();return B(()=>{var c;(c=a.value)==null||c.replaceWith(s)}),(c,u)=>(r(),d("div",{ref_key:"el",ref:a},null,512))}});const z=n=>(L("data-v-2f2b0038"),n=n(),F(),n),O=z(()=>M("option",{disabled:"",value:""},"Choose an option...",-1)),W=["value"],G={key:1,class:"log"},J={key:2,class:"log"},Q={key:3,class:"log"},R=["onSubmit"],X=N("\u2714");function le(){const n={...globalThis.console,bindKey(t,e){n.focus(),f.push((l,o)=>(t===l&&(o(),e()),!0))},clear(){s.splice(0,s.length)},error(t,...e){s.push({type:"error",id:Math.random(),content:e.length?[t,...e]:t})},focus(){var t;(t=s.focus)==null||t.call(s)},key(t){return new Promise(e=>{n.focus(),f.push((l,o)=>{if(t===l){o(),e();return}return!0})})},line(){s.push({type:"line",id:Math.random()})},log(t,...e){s.push({type:"log",id:Math.random(),content:e.length?[t,...e]:t})},prompt(t,e){return a.value=t,n.focus(),new Promise(l=>{e?i.push(o=>{if(o)a.value="",l(o);else return!0}):i.push(o=>{a.value="",l(o)})})},select(t,e){const l=Math.random();return s.push({id:l,label:t,options:e,type:"select"}),setTimeout(n.focus),new Promise(o=>{u[l]=o})},user(t,...e){s.push({type:"user",id:Math.random(),content:e.length?[t,...e]:t})},warn(t,...e){s.push({type:"warn",id:Math.random(),content:e.length?[t,...e]:t})}},s=D([]),a=b(""),c=b(""),u=Object.create(null),i=[],f=[];return{console:n,field:c,messages:s,placeholder:a,onKey(t,e){f.splice(0,f.length,...f.filter(l=>l(t,e)))},onSelect(t,e){var l;(l=u[t])==null||l.call(u,e),delete u[t]},onSubmit(t){i.splice(0,i.length,...i.filter(e=>e(t)))}}}const Y=v({__name:"Console",props:{field:null,messages:null,placeholder:null,stretch:{type:Boolean}},emits:["key","select","submit","update:field","update:messages"],setup(n,{emit:s}){const a=n;function c(){if(a.field){const e={type:"user",id:Math.random(),content:a.field};s("update:messages",a.messages.concat(e))}s("update:field",""),s("submit",a.field?a.field:void 0)}function u(e){let l=!1;s("key","Enter",()=>l=!0),l?e.preventDefault():c()}const i=b();a.messages.focus=()=>{var e,l;(l=(e=V(i))==null?void 0:e.querySelector("select:not([disabled]), input"))==null||l.focus()};const f=a.messages,t=e=>e instanceof globalThis.Node;return(e,l)=>(r(),_(K,{ref_key:"consoleEl",ref:i,class:C([{stretch:n.stretch},"console"])},{default:p(()=>[(r(!0),d(g,null,S(x(f),o=>(r(),d(g,{key:o.id},[o.type==="select"?(r(),_(H,{key:0,class:"log",label:o.label,style:{"margin-bottom":"0.25em"}},{default:p(()=>[m($,{class:"select",disabled:!!o.selected,"model-value":o.selected||"","onUpdate:modelValue":h=>h&&(o.selected=h)&&e.$emit("select",o.id,h)},{default:p(()=>[O,(r(!0),d(g,null,S(o.options,(h,k)=>(r(),d("option",{key:k,value:k},y(h),9,W))),128))]),_:2},1032,["disabled","model-value","onUpdate:modelValue"])]),_:2},1032,["label"])):o.type==="line"?(r(),d("hr",G)):Array.isArray(o.content)?(r(),d("p",J,y(o.content.join(" ")),1)):t(o.content)?(r(),d("p",Q,[m(q,{node:o.content},null,8,["node"])])):(r(),d("p",{key:4,class:C([o.type,"log"])},y(o.content),3))],64))),128)),M("form",{class:"form",style:{"margin-top":"auto"},onSubmit:E(c,["prevent"])},[m(j,{space:.75},{default:p(()=>[m(U,{ref:"fieldEl",class:"field","model-value":n.field?n.field:"",placeholder:n.placeholder,onKeydown:l[0]||(l[0]=o=>e.$emit("key",o.key,()=>o.preventDefault())),"onUpdate:modelValue":l[1]||(l[1]=o=>e.$emit("update:field",o))},null,8,["model-value","placeholder"]),m(I,{onClick:u},{default:p(()=>[X]),_:1})]),_:1},8,["space"])],40,R)]),_:1},8,["class"]))}});var se=T(Y,[["__scopeId","data-v-2f2b0038"]]);export{se as C,le as u};

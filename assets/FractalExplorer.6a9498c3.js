import{d as v,o as p,h as y,s as L,c as w,a as r,p as A,j,b as x,as as X,e as s,g as B,v as G,at as M,m as _,au as Y,f as F,i as O,q as P}from"./index.b4be34e9.js";import{_ as b,B as R,H as J}from"./Modal.2020aac2.js";import{F as Z}from"./Field.6d00265b.js";import{F as q}from"./useWebGL.8be00d0f.js";import{s as h,u as ee}from"./useMovableCanvas.dadf4d48.js";const te=["value"],le=v({__name:"Dropdown",props:{modelValue:null},emits:["update:modelValue"],setup(e){return(l,t)=>(p(),y("select",{class:"field focusline second-layer",value:l.$props.modelValue,onChange:t[0]||(t[0]=a=>l.$emit("update:modelValue",a.target.value))},[L(l.$slots,"default",{},void 0,!0)],40,te))}});var ne=b(le,[["__scopeId","data-v-7132250d"]]);const N=v({__name:"IconButton",setup(e){return(l,t)=>(p(),w(R,{center:"",style:{width:"2.5em",height:"2.25em"}},{default:r(()=>[L(l.$slots,"default")]),_:3}))}});const ae={},oe=e=>(A("data-v-0298e8c4"),e=e(),j(),e),ue={class:"icon",viewBox:"0 0 485.064 485.064",xmlns:"http://www.w3.org/2000/svg"},se=oe(()=>x("path",{d:`M458.736,181.097H26.334C11.793,181.097,0,192.884,0,207.425v70.215c0,14.541,11.787,26.328,26.334,26.328h432.402\r
      c14.541,0,26.328-11.787,26.328-26.328v-70.215C485.07,192.884,473.283,181.097,458.736,181.097z`},null,-1)),ie=[se];function re(e,l){return p(),y("svg",ue,ie)}var de=b(ae,[["render",re],["__scopeId","data-v-0298e8c4"]]);const ce={},pe=e=>(A("data-v-079820ed"),e=e(),j(),e),me={class:"icon",viewBox:"0 0 60.364 60.364",xmlns:"http://www.w3.org/2000/svg"},fe=pe(()=>x("path",{d:`M54.454,23.18l-18.609-0.002L35.844,5.91C35.845,2.646,33.198,0,29.934,0c-3.263,0-5.909,2.646-5.909,5.91v17.269\r
		L5.91,23.178C2.646,23.179,0,25.825,0,29.088c0.002,3.264,2.646,5.909,5.91,5.909h18.115v19.457c0,3.267,2.646,5.91,5.91,5.91\r
		c3.264,0,5.909-2.646,5.91-5.908V34.997h18.611c3.262,0,5.908-2.645,5.908-5.907C60.367,25.824,57.718,23.178,54.454,23.18z`},null,-1)),ve=[fe];function _e(e,l){return p(),y("svg",me,ve)}var he=b(ce,[["render",_e],["__scopeId","data-v-079820ed"]]);const be=["autocomplete","placeholder","type","value"],ye=v({__name:"InlineField",props:{modelValue:null,type:null,autocomplete:null,placeholder:null},emits:["update:modelValue"],setup(e){return(l,t)=>{var a,n;return p(),y("input",{class:"field",autocomplete:(a=e.autocomplete)!=null?a:"off",placeholder:e.placeholder,style:X({width:e.modelValue.length+2+"ch"}),type:(n=e.type)!=null?n:"text",value:e.modelValue,onInput:t[0]||(t[0]=i=>l.$emit("update:modelValue",i.target.value))},null,44,be)}}});var xe=b(ye,[["__scopeId","data-v-3d0155ac"]]);const Ve=v({__name:"InlineNumericField",props:{modelValue:null,autocomplete:null,placeholder:null},emits:["update:modelValue"],setup(e){return(l,t)=>(p(),w(xe,{autocomplete:e.autocomplete,"model-value":""+e.modelValue,placeholder:e.placeholder,type:"number","onUpdate:modelValue":t[0]||(t[0]=a=>l.$emit("update:modelValue",+a))},null,8,["autocomplete","model-value","placeholder"]))}});const we=v({__name:"Incrementable",props:{modelValue:null,decrement:{type:Function,default:e=>e-1},increment:{type:Function,default:e=>e+1},label:null},emits:["update:modelValue"],setup(e){function l({target:t}){var a;(a=t.querySelector("input"))==null||a.focus()}return(t,a)=>(p(),w(J,null,{default:r(()=>[s(N,{onClick:a[0]||(a[0]=n=>t.$emit("update:modelValue",e.decrement(e.modelValue)))},{default:r(()=>[s(de)]),_:1}),x("p",{class:"label",onClick:l},[B(G(e.label)+" ",1),s(Ve,{"model-value":e.modelValue,"onUpdate:modelValue":a[1]||(a[1]=n=>t.$emit("update:modelValue",n))},null,8,["model-value"])]),s(N,{onClick:a[2]||(a[2]=n=>t.$emit("update:modelValue",e.increment(e.modelValue)))},{default:r(()=>[s(he)]),_:1})]),_:1}))}});var T=b(we,[["__scopeId","data-v-6b56d56b"]]);const ke=["autocomplete","checked","type"],$e=v({__name:"InlineCheckboxField",props:{modelValue:{type:Boolean},type:null,autocomplete:null},emits:["update:modelValue"],setup(e){return(l,t)=>{var a,n;return p(),y("input",{class:"field",autocomplete:(a=e.autocomplete)!=null?a:"off",checked:e.modelValue,type:(n=e.type)!=null?n:"checkbox",onChange:t[0]||(t[0]=i=>l.$emit("update:modelValue",i.target.checked))},null,40,ke)}}});var ge=b($e,[["__scopeId","data-v-5a55106d"]]);const ze=["autocomplete","max","min","step","value"],Ie=v({__name:"InlineRangeField",props:{modelValue:null,autocomplete:null,min:null,max:null,step:null},emits:["update:modelValue"],setup(e){return(l,t)=>{var a;return p(),y("input",{class:"field",autocomplete:(a=e.autocomplete)!=null?a:"off",max:e.max,min:e.min,step:e.step,value:e.modelValue,type:"range",onInput:t[0]||(t[0]=n=>l.$emit("update:modelValue",+n.target.value))},null,40,ze)}}});var S=b(Ie,[["__scopeId","data-v-13b05489"]]);const Ce={class:"label"},Fe={class:"nowrap"},Ue=v({__name:"Labeled",props:{label:null},setup(e){return(l,t)=>(p(),y("label",Ce,[s(J,null,{default:r(()=>[x("span",Fe,G(e.label),1),L(l.$slots,"default",{},void 0,!0)]),_:3})]))}});var V=b(Ue,[["__scopeId","data-v-c154c8f4"]]);let Se={"+":2,"-":2,"*":3,"/":3,"**":4,"^":5};function H(e){return e=="("?0:Se[e]||1}let Re={"+":"l","-":"l","*":"l","/":"l"};function Le(e){return Re[e]||"r"}let Be=["+","-","*","/","^","("];function Q(e){return!Be.includes(e)}function De(e){let l=[],t=!1;for(;;){let u;if(e.length===0)break;(u=e.match(/^\d+(?:\.\d+)?/))?(t&&l.push("**"),t=!0,l.push(+u[0]),e=e.slice(u[0].length)):(u=e.match(/^(sin|cos|tan|exp|log|abs|min|max|rawsqr)/))?(t&&l.push("**"),t=!1,l.push(u[0]),e=e.slice(u[0].length)):(u=e.match(/^(pi|pz|ppz|sz|e|i|c|z)/))?(t&&l.push("**"),t=!0,l.push(u[0]),e=e.slice(u[0].length)):((u=e.match(/^[-+*\/^()]/))&&(t&&u[0]=="("&&l.push("**"),t=!1,u[0]==")"&&(t=!0),l.push(u[0])),e=e.slice(1))}let a=[],n=[],i;for(;i=l.shift();)if(typeof i=="number"||i.match(/^(pi|pz|ppz|sz|e|i|c|z)$/))a.push(i);else if(i==")"){for(;n[n.length-1]!="(";){let m=n[n.length-1];if(!m)return["z"];n.pop(),a.push(m)}if(n.pop()!="(")return["z"];let u=n[n.length-1];if(!u)continue;Q(u)&&(n.pop(),a.push(u))}else if(i=="("||Q(i))n.push(i);else{let u=i,m;for(;(m=n[n.length-1])&&m!="(";){let f=H(u),k=H(m);if(!(k>f||f==k&&Le(u)=="l"))break;a.push((n.pop(),m))}n.push(u)}for(;i=n.pop();){if(i=="("||i==")")return["z"];a.push(i)}return a}function Ee(e){try{let l=[];for(let t of e)if(typeof t=="number")l.push(`vec2(${t}, 0)`);else if(t=="i")l.push("vec2(0, 1)");else if(t=="pi")l.push("vec2(3.141592653589793, 0)");else if(t=="e")l.push("vec2(2.718281828459045, 0)");else if(t.match(/^(pz|ppz|sz|c|z)$/))l.push(t);else if(t=="+"||t=="-"){let a=l.pop(),n=l.pop();l.push(`${n} ${t} ${a}`)}else if(t=="*"||t=="**"||t=="/"||t=="^"||t=="min"||t=="max"){t=="/"?t="div":t=="^"?t="power":(t=="*"||t=="**")&&(t="mult");let a=l.pop(),n=l.pop();l.push(`${t}(${n}, ${a})`)}else(t=="sin"||t=="cos"||t=="tan"||t=="exp"||t=="log"||t=="abs"||t=="rawsqr")&&l.push(`${t}(${l.pop()})`);return l.length!=1?"z":l[0]}catch{return"z"}}function Me(e){return Ee(De(e))}const Oe=B("Apply Equation"),Pe=x("option",{value:"rainbow"},"Rainbow",-1),Ne=x("option",{value:"newton"},"Newton",-1),Te=B(" Reset Position "),Je=v({__name:"FractalExplorer",setup(e){const l=M(100,5,1/0);h("detail",l);function t(o){return o<=10?5:o<=25?5*Math.ceil((o-5)/5):o<=50?25:50*Math.ceil((o-50)/50)}function a(o){return o<10?10:o<25?5*~~((o+5)/5):o<50?50:50*~~((o+50)/50)}const n=M(2,.1,1/0);h("limit",n);function i(o){return o<=2?Math.ceil(10*(o-.1))/10:Math.ceil(o-1)}function u(o){return o<2?~~(10*(o+.1))/10:~~(o+1)}const m=_("z^2+c");h("equation",m);const f=_("rainbow");h("theme",f);const k={rainbow:1,newton:2},K=Y(()=>k[f.value]),$=_(0);h("colorOffset",$);const g=_(1);h("colorRepetition",g);const z=_(1);h("spectrum",z);const I=_(!1);h("darkness",I);const W="in vec2 pos;out vec4 color;uniform int detail;uniform float limit;uniform int theme;uniform float colorOffset;uniform float colorRepetition;uniform float spectrum;uniform bool darkness;float pi=3.1415926535;vec3 hsl2rgb(vec3 c){vec3 rgb=clamp(abs(mod(c.x*6.0+vec3(0.0,4.0,2.0),6.0)-3.0)-1.0,0.0,1.0);return c.z+c.y*(rgb-0.5)*(1.0-abs(2.0*c.z-1.0));}vec3 palette(float t){float hue=mod(2.0*colorRepetition*t,1.0);vec3 hsl=vec3(1.0-hue*spectrum,1,0.5);if(darkness)hsl.z=mod(2.0*t,1.0);hsl.x=mod(hsl.x+colorOffset,1.0);return hsl2rgb(hsl);}vec3 newtonPalette(float t){float hue=mod(t/pi,1.0)*spectrum;hue=mod(hue+colorOffset,1.0);return hsl2rgb(vec3(1.0-hue,1.0,0.5));}vec2 cube(vec2 a){float x2=a.x*a.x;float y2=a.y*a.y;float d=x2-y2;return vec2(a.x*(d-y2-y2),a.y*(x2+x2+d));}vec2 sqr(vec2 a){return vec2(a.x*a.x-a.y*a.y,2.0*a.x*a.y);}vec2 rawsqr(vec2 a){return a*a;}vec2 mult(vec2 a,vec2 b){float x=a.x*b.x-a.y*b.y;float y=a.x*b.y+a.y*b.x;return vec2(x,y);}vec2 div(vec2 a,vec2 b){float denom=1.0/(b.x*b.x+b.y*b.y);return vec2(a.x*b.x+a.y*b.y,a.y*b.x-a.x*b.y)*denom;}vec2 power(vec2 a,vec2 b){int count=int(b.x);if(count<=1)return a;vec2 result=a;for(int i=1;i<count;i++){result=mult(result,a);}return result;}void main(){vec2 pz,ppz,nz,c=pos,z=pos;vec3 sz;for(int i=0;i<detail;i++){ppz=pz;pz=z;z={{EQ}};if(theme==1&&length(z)>limit){color=vec4(palette(float(i)*0.01),1);return;}if(darkness&&theme==2)nz+=z;}if(theme==2){if(darkness)z=nz;color=vec4(newtonPalette(atan(z.y/z.x)),1);return;}color=vec4(0,0,0,1);}",D=_();let C,U=_();function E(){C==null||C(),ee(D,W.replace("{{EQ}}",Me(m.value))).then(o=>{o.useUniform("detail","i",l),o.useUniform("limit","f",n),o.useUniform("theme","i",K),o.useUniform("colorOffset","f",$),o.useUniform("colorRepetition","f",g),o.useUniform("spectrum","f",z),o.useUniform("darkness","f",I),C=o.destroy,U.value=()=>{o.bounds.xStart.value=-2,o.bounds.xEnd.value=2,o.bounds.yStart.value=-2,o.bounds.yEnd.value=2}})}return E(),(o,d)=>(p(),w(q,null,{options:r(()=>[s(T,{modelValue:F(l),"onUpdate:modelValue":d[0]||(d[0]=c=>O(l)?l.value=c:null),decrement:t,increment:a,label:"Detail Level:"},null,8,["modelValue"]),s(T,{modelValue:F(n),"onUpdate:modelValue":d[1]||(d[1]=c=>O(n)?n.value=c:null),decrement:i,increment:u,label:"Fractal Size:"},null,8,["modelValue"]),s(V,{label:"Equation:"},{default:r(()=>[s(Z,{modelValue:m.value,"onUpdate:modelValue":d[2]||(d[2]=c=>m.value=c)},null,8,["modelValue"]),s(R,{style:{"white-space":"pre"},onClick:E},{default:r(()=>[Oe]),_:1})]),_:1}),s(V,{label:"Theme:"},{default:r(()=>[s(ne,{modelValue:f.value,"onUpdate:modelValue":d[3]||(d[3]=c=>f.value=c)},{default:r(()=>[Pe,Ne]),_:1},8,["modelValue"])]),_:1}),s(V,{label:"Color Offset:"},{default:r(()=>[s(S,{modelValue:$.value,"onUpdate:modelValue":d[4]||(d[4]=c=>$.value=c),max:1,min:0,step:"any"},null,8,["modelValue"])]),_:1}),f.value!="newton"?(p(),w(V,{key:0,label:"Color Repetition:"},{default:r(()=>[s(S,{modelValue:g.value,"onUpdate:modelValue":d[5]||(d[5]=c=>g.value=c),max:10,min:-10,step:"any"},null,8,["modelValue"])]),_:1})):P("",!0),s(V,{label:"Color Spectrum:"},{default:r(()=>[s(S,{modelValue:z.value,"onUpdate:modelValue":d[6]||(d[6]=c=>z.value=c),max:1,min:0,step:"any"},null,8,["modelValue"])]),_:1}),s(V,{label:f.value=="newton"?"3D Effect?":"Darkness Effect?"},{default:r(()=>[s(ge,{modelValue:I.value,"onUpdate:modelValue":d[7]||(d[7]=c=>I.value=c)},null,8,["modelValue"])]),_:1},8,["label"])]),buttons:r(()=>[F(U)?(p(),w(R,{key:0,onClick:F(U)},{default:r(()=>[Te]),_:1},8,["onClick"])):P("",!0)]),default:r(()=>[x("canvas",{ref_key:"canvas",ref:D},null,512)]),_:1}))}});export{Je as default};

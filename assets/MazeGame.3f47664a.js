import{d as Y,k,G as W,a4 as H,a9 as T,aF as L,o as X,c as q,w as N,a as D}from"./index.7141cb12.js";import{F as V}from"./FullscreenDisplay.7eaa98f9.js";import{u as R}from"./useCanvas.b5d02c4a.js";import{_ as J}from"./VStack.9632794c.js";import"./BookmarkIcon.e2141b75.js";function C(t,r){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);r&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function S(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{};r%2?C(Object(n),!0).forEach(function(o){K(t,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(n,o))})}return t}function K(t,r,n){return r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function B(t){return t.slice(0,-1)}function F(t,r=0){return r?Array.from(Array(r-t).keys()).map(n=>n+t):Array.from(Array(t).keys())}function G(t){return[...new Set(t)]}function I(t,r){const n=G(t.map(p=>p.set)).filter(Boolean),o=(e=F(1,t.length+1),h=n,[e,h].reduce((p,g)=>p.filter(x=>!g.includes(x)))).sort(()=>.5-r());var e,h;t.filter(p=>!p.set).forEach((p,g)=>p.set=o[g])}function A(t,r,n=.5){B(t).forEach((o,e)=>{const h=t[e+1],p=o.set!==h.set,g=r()<=n;p&&g&&(function(x,f,s){x.forEach(d=>{d.set===f&&(d.set=s)})}(t,h.set,o.set),o.right=!1,h.left=!1)})}function Q(t=8,r=t,n=!0,o=1){const e=function(f){return function(){let s=f+=1831565813;return s=Math.imul(s^s>>>15,1|s),s^=s+Math.imul(s^s>>>7,61|s),((s^s>>>14)>>>0)/4294967296}}(o),h=[],p=F(t);for(let f=0;f<r;f+=1){const s=p.map(d=>({x:d,y:f,top:n||f>0,left:n||d>0,bottom:n||f<r-1,right:n||d<t-1}));h.push(s)}B(h).forEach((f,s)=>{I(f,e),A(f,e),function(d,P,z){const j=Object.values(function(y,v){let c=G(y.map(b=>b.set)).reduce((b,i)=>S(S({},b),{},{[i]:[]}),{});return y.forEach(b=>c[b.set].push(b)),c}(d)),{ceil:E}=Math;j.forEach(y=>{(function(v,c,b){c=c==null?1:c;const i=v==null?0:v.length;if(!i||c<1)return[];c=c>i?i:c;let l=-1;const O=i-1,a=[...v];for(;++l<c;){const _=l+Math.floor(b()*(O-l+1)),m=a[_];a[_]=a[l],a[l]=m}return a.slice(0,c)})(y,E(z()*y.length),z).forEach(v=>{if(v){const c=P[v.x];v.bottom=!1,c.top=!1,c.set=v.set}})})}(f,h[s+1],e)});const g=(x=h)[x.length-1];var x;return I(g,e),A(g,e,1),h}const U=Y({__name:"MazeGame",setup(t){var b;const r=k(),n=k(),o=k(),e=32,h=12,p=e/2,g=e/4;let x=0,f=0;const s=k(0),d=k(0);(b=window.DeviceMotionEvent)==null||b.requestPermission();const{beta:P,gamma:z}=W(),{x:j,y:E}=H(),y=T(()=>{var i;return(i=P.value)!=null?i:180*j.value/innerWidth-90}),v=T(()=>{var i;return(i=z.value)!=null?i:180*E.value/innerWidth-90}),c=T(()=>y.value<-30&&y.value<-Math.abs(v.value)?"right":y.value>30&&y.value>Math.abs(v.value)?"left":v.value<-30&&v.value<-Math.abs(y.value)?"down":v.value>30&&v.value>Math.abs(y.value)?"up":"none");return R(r,{useDevicePixelRatio:!1}).then(i=>{const{canvas:l,onResize:O}=i,a=l.getContext("2d");if(!a)throw new Error("Your device does not support HTML5 canvases.");function _(){if(!o.value&&l.width>4*e&&l.height>4*e){const m=~~(l.width/e)-2,u=~~(l.height/e)-2;o.value=Q(m,u,!0,~~(Math.random()*1e6)),x=m,f=u}}_(),o.value||O(_),L(()=>{a.clearRect(0,0,l.width,l.height),a.beginPath();let m=s.value*e+e+p,u=d.value*e+e+p;m+=c.value==="left"?-g:c.value==="right"?g:0,u+=c.value==="up"?-g:c.value==="down"?g:0,a.fillStyle="black",a.moveTo(m,u),a.arc(m,u,h,0,2*Math.PI),a.fill()}),setInterval(()=>{var w;if(!o.value)return;const m=c.value,u=(w=o.value)==null?void 0:w[d.value][s.value];s.value+=m==="left"&&!u.left?-1:m==="right"&&!u.right?1:0,d.value+=m==="up"&&!u.top?-1:m==="down"&&!u.bottom?1:0,s.value=Math.max(0,Math.min(x,s.value)),d.value=Math.max(0,Math.min(f,d.value))},1e3)}),R(n,{useDevicePixelRatio:!1}).then(i=>{const{canvas:l,onResize:O}=i,a=l.getContext("2d");if(!a)throw new Error("Your device does not support HTML5 canvases.");function _(){if(a.fillStyle="white",a.fillRect(0,0,l.width,l.height),!!o.value)for(const m of o.value)for(const u of m){a.lineWidth=2,a.strokeStyle="black",a.lineCap="round";const w=u.x*e+e,M=u.y*e+e;u.top&&(a.moveTo(w,M),a.lineTo(w+e,M),a.stroke()),u.left&&(a.moveTo(w,M),a.lineTo(w,M+e),a.stroke()),u.right&&(a.moveTo(w+e,M),a.lineTo(w+e,M+e),a.stroke()),u.bottom&&(a.moveTo(w,M+e),a.lineTo(w+e,M+e),a.stroke())}}_(),O(()=>setTimeout(_,100))}),(i,l)=>(X(),q(V,null,{default:N(()=>[D("canvas",{ref_key:"mazeImage",ref:n,class:"maze-image"},null,512),D("canvas",{ref_key:"canvas",ref:r,class:"main"},null,512)]),_:1}))}});var ne=J(U,[["__scopeId","data-v-2c246454"]]);export{ne as default};

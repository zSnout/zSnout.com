import{d as W,r as w,g as j,c as E,w as x,o as L,a as b}from"./index.xh0zaea0.js";import{F as O}from"./FullscreenDisplay.75rpamat.js";import{u as T}from"./useCanvas.3phirwm2.js";import{u as U,a as V}from"./useVideoFromStream.1vimuw6x.js";import"./BookmarkIcon.1ijfs95x.js";import"./VStack.3evi6szx.js";import"./Field.5c7fkv56.js";import"./LogoLight.3fmf1259.js";import"./SharedNav.4z4l3m5g.js";function Y(c){const n=document.createElement("canvas"),o=n.getContext("2d");return{canvas:n,ctx:o,update:(i=c.videoWidth,l=c.videoHeight)=>{n.width=i,n.height=l,o.drawImage(c,0,0,i,l)}}}const h=9,u=7.5,m="$@B%8&WM#*oahkbdpqwmZO0QLCJUYXzcvunxrjft/\\|()1{}[]?-_+~<>i!lI;:,\"^`'.  ",K=W({__name:"ascii-art",setup(c){const n=w(),o=w("user"),{stream:i,setOpts:l}=U({audio:!1,video:{facingMode:{ideal:o.value}}});function M(){o.value=o.value==="user"?"environment":"user",l({audio:!1,video:{facingMode:{ideal:o.value}}})}const _=V(i,!0),{ctx:d,update:C}=Y(_);return T(n,{useDevicePixelRatio:!1}).then(f=>{const{canvas:r}=f,a=r.getContext("2d");if(!a)throw new Error("Your device doesn't support HTML5 canvases.");j(()=>{if(!i.value)return;C(~~(r.width/u),~~(r.height/h));const t=d.getImageData(0,0,d.canvas.width,d.canvas.height);a.beginPath(),a.fillStyle="black",a.fillRect(0,0,r.width,r.height);for(let e=0;e<t.height;e++)for(let s=0;s<t.width;s++){const[p,v,g]=t.data.subarray(4*(e*t.width+s),4*(e*t.width+s)+3),[y,k,B]=t.data.subarray(4*(e*t.width+Math.max(0,s-1)),4*(e*t.width+Math.max(0,s-1))+3),[F,S,z]=t.data.subarray(4*(Math.max(0,e-1)*t.width+s),4*(Math.max(0,e-1)*t.width+s)+3),D=(Math.abs(p-y)+Math.abs(p-F))/2,H=(Math.abs(v-k)+Math.abs(v-S))/2,I=(Math.abs(g-B)+Math.abs(g-z))/2,P=.2126*D+.7152*H+.0722*I,R=m[m.length-1-~~(P*m.length/256)];a.beginPath(),a.fillStyle="white",a.font=`${h}px monospace`,a.textAlign="center",a.textBaseline="middle",a.fillText(R,s*u+u/2,e*h+h/2)}})}),(f,r)=>(L(),E(O,null,{indicator:x(()=>[b("span",{style:{cursor:"pointer"},onClick:M},"Switch Camera")]),default:x(()=>[b("canvas",{ref_key:"canvas",ref:n},null,512)]),_:1}))}});export{K as default};

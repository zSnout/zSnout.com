import{d as e,o as c,c as p,w as a,k as u,a as n,b as s}from"./index.v5ospewp.js";const l=n("div",{class:"markdown-body"},[n("p",null,[s("About 3 months ago, I published an article titled "),n("a",{href:"/blog/lets-make-a-web-framework"},"Let\u2019s Make A Web Framework"),s(". While it was a fun article to write, I\u2019ve been working on another reactivity system for JavaScript that I think is better, and I want to share it with you. Let\u2019s dive in!")]),n("h2",{id:"prerequisites",tabindex:"-1"},"Prerequisites"),n("p",null,"Before you read this article, you should be comfortable with some elements of JavaScript. If you don\u2019t know any JavaScript, this article may not be good for you. You should also catch up on ES6 constructs, as we\u2019ll use them frequently. Specifically, we\u2019ll use the following concepts in our code:"),n("ul",null,[n("li",null,"destructuring"),n("li",null,"arrow functions"),n("li",null,[n("code",{class:""},"let"),s(" and "),n("code",{class:""},"const"),s(" variables")]),n("li",null,"passing functions as parameters"),n("li",null,[n("code",{class:""},"Set"),s("s")]),n("li",null,"instanceof"),n("li",null,"typeof"),n("li",null,[n("code",{class:""},"== null"),s(" to check for "),n("code",{class:""},"null"),s(" and "),n("code",{class:""},"undefined")]),n("li",null,"spread and rest syntax"),n("li",null,"shorthand object methods")]),n("p",null,"If you don\u2019t know all of these, don\u2019t worry. Just Google them and you\u2019ll get the hang of the concepts behind them pretty quickly. Now, let\u2019s get on to the actual article!"),n("h2",{id:"the-reactive-primitives",tabindex:"-1"},"The reactive primitives"),n("p",null,"The system described in the article above had two reactive primitives: effects and signals. However, I noticed that signals store values, which doesn\u2019t really make them actual primitives, as the value behavior could be implemented from a smaller construct. Instead, this article will use events instead of signals. While they have the same name as DOM events, our events will have a different, simpler API."),n("p",null,[s("When an event is created, it will return a "),n("code",{class:""},"track"),s(" function and a "),n("code",{class:""},"trigger"),s(" function. When the "),n("code",{class:""},"track"),s(" function is called from inside an effect, the effect will be added to the event\u2019s subscriber list. When the "),n("code",{class:""},"trigger"),s(" function is called, any effects that have called "),n("code",{class:""},"track"),s(" will be re-run.")]),n("p",null,"Hopefully that isn\u2019t too complicated to follow. Just in case, I\u2019ll provide a quick code example of what we want to do in the end."),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("track"),n("span",{class:"token punctuation"},","),s(" trigger"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"event"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// This should be run whenever `trigger` is called."),s(`

  `),n("span",{class:"token function"},"track"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
  console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"first effect"'),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token comment"},"// But this effect will only be run once, because"),s(`
  `),n("span",{class:"token comment"},"// it didn't subscribe using `track`."),s(`

  console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"second effect"'),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token function"},"trigger"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("p",null,[s("These seem pretty easy to implement. First, we\u2019ll create the "),n("code",{class:""},"effect"),s(" function. We\u2019ll store the currently running effect, if any, in "),n("code",{class:""},"currentEffect"),s(".")]),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"let"),s(` currentEffect

`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"fn"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  currentEffect `),n("span",{class:"token operator"},"="),s(` fn
  `),n("span",{class:"token function"},"fn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
  currentEffect `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"undefined"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("p",null,[s("This looks good, but there\u2019s a small issue. If an effect is running inside of another, "),n("code",{class:""},"currentEffect"),s(" will be cleared instead of preserving the parent effect. This is a pretty simple fix; we\u2019ll just store the parent effect in a variable.")]),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"let"),s(` currentEffect

`),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"fn"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" parentEffect "),n("span",{class:"token operator"},"="),s(` currentEffect
  currentEffect `),n("span",{class:"token operator"},"="),s(` fn
  `),n("span",{class:"token function"},"fn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
  currentEffect `),n("span",{class:"token operator"},"="),s(` parentEffect
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("p",null,[s("Looks like "),n("code",{class:""},"effect"),s(" is done. Let\u2019s move on to "),n("code",{class:""},"event"),s(" now. We\u2019ll store the list of subscribers in a Set called "),n("code",{class:""},"tracking"),s(". By using a Set instead of an array, we won\u2019t have to check for duplicate effects, which would be bad. We\u2019ll also return a tuple where the first element is "),n("code",{class:""},"track"),s(" and the second is "),n("code",{class:""},"trigger"),s(". This lets a developer rename the elements to whatever they want using destructuring.")]),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"event"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" tracking "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Set"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"["),s(`
    `),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("currentEffect"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        tracking`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"add"),n("span",{class:"token punctuation"},"("),s("currentEffect"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      tracking`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"effect"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"]"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("p",null,"And we\u2019re done! We can\u2019t track values or derived stores, but the core of the library is complete."),n("h2",{id:"values-and-memos",tabindex:"-1"},"Values and memos"),n("p",null,[s("Well, complete is a bit of an overstatement. We should "),n("em",null,"really"),s(" implement value trackers and derived stores ourselves and not force developers to do all the work. We\u2019ll call reactive values signals. They should be easy to implement, as we can just use "),n("code",{class:""},"track"),s(" and "),n("code",{class:""},"trigger"),s(" for getters and setters, respectively. We\u2019ll return a tuple of two elements: a function that gets the current value (and tracks the current effect), and a function that sets the current values (and trigger any tracked effects).")]),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"signal"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"value"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("track"),n("span",{class:"token punctuation"},","),s(" trigger"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"event"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"["),s(`
    `),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token function"},"track"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token keyword"},"return"),s(` value
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"newValue"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      value `),n("span",{class:"token operator"},"="),s(` newValue
      `),n("span",{class:"token function"},"trigger"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"]"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("p",null,"Here\u2019s an example of using signals:"),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("age"),n("span",{class:"token punctuation"},","),s(" setAge"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"signal"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"14"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"current age:"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token function"},"age"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token function"},"setAge"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"13"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token function"},"setAge"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"17"),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("p",null,"It almost feels too easy! I used to wonder about how libraries like React and Vue were able to implement reactivity in a library less than a single megabyte, but now I wonder about how it took them that much space when our libraries are so much smaller. Of course, we haven\u2019t implemented memos (derived stores) yet, and I\u2019m sure those will be very complicated\u2026"),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("age"),n("span",{class:"token punctuation"},","),s(" setAge"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"signal"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"14"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"doubled"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token number"},"2"),s(),n("span",{class:"token operator"},"*"),s(),n("span",{class:"token function"},"age"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("p",null,[s("Nope. Because we just used plain functions, we can just make a wrapper function. There is one small worry: if "),n("code",{class:""},"doubled"),s(" is called in a parent effect, it may end up being re-run when another signal changes, like in this example:")]),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("age"),n("span",{class:"token punctuation"},","),s(" setAge"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"signal"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"14"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token function-variable function"},"doubled"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token number"},"2"),s(),n("span",{class:"token operator"},"*"),s(),n("span",{class:"token function"},"age"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("name"),n("span",{class:"token punctuation"},","),s(" setName"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"signal"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"zSnout"'),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
  console`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"log"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"name"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},'"is"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token function"},"doubled"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token function"},"setAge"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"37"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token function"},"setName"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"Zachary"'),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("p",null,[s("Whoops! "),n("code",{class:""},"doubled"),s(" is getting called even though it only needs to track "),n("code",{class:""},"age"),s(". Of course, there\u2019s an easy solution to this. We\u2019ll create a helper function called "),n("code",{class:""},"memo"),s(" that creates an effect around "),n("code",{class:""},"doubled"),s(" and only updates if direct dependencies of "),n("code",{class:""},"doubled"),s(" change.")]),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"memo"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"compute"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("get"),n("span",{class:"token punctuation"},","),s(" set"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"signal"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"set"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"compute"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"return"),s(` get
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("p",null,"That code block is so small it feels like cheating, but it really works! Our primitives are so good that our helpers barely have to do any work."),n("p",null,[s("Let\u2019s get on to the dreaded measurement of our JavaScript package: how big is it, minified? We want to be able to serve a tiny bundle to our users, so let\u2019s find out. First, I\u2019ll copy and paste our full code here and "),n("code",{class:""},"export"),s(" all of our functions.")]),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"let"),s(` currentEffect

`),n("span",{class:"token keyword"},"export"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"fn"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" parentEffect "),n("span",{class:"token operator"},"="),s(` currentEffect
  currentEffect `),n("span",{class:"token operator"},"="),s(` fn
  `),n("span",{class:"token function"},"fn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
  currentEffect `),n("span",{class:"token operator"},"="),s(` parentEffect
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"export"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"event"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" tracking "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Set"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"["),s(`
    `),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("currentEffect"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        tracking`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"add"),n("span",{class:"token punctuation"},"("),s("currentEffect"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      tracking`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"effect"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"]"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"export"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"signal"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"value"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("track"),n("span",{class:"token punctuation"},","),s(" trigger"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"event"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"["),s(`
    `),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token function"},"track"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token keyword"},"return"),s(` value
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"newValue"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      value `),n("span",{class:"token operator"},"="),s(` newValue
      `),n("span",{class:"token function"},"trigger"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"]"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"export"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"memo"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"compute"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("get"),n("span",{class:"token punctuation"},","),s(" set"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"signal"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"set"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"compute"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"return"),s(` get
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("p",null,"Now let\u2019s plug it into esbuild and watch magic happen:"),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"var"),s(" n"),n("span",{class:"token punctuation"},";"),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"o"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"t"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token keyword"},"let"),s(" e"),n("span",{class:"token operator"},"="),s("n"),n("span",{class:"token punctuation"},";"),s("n"),n("span",{class:"token operator"},"="),s("t"),n("span",{class:"token punctuation"},","),n("span",{class:"token function"},"t"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s("n"),n("span",{class:"token operator"},"="),s("e"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"f"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token keyword"},"let"),s(" t"),n("span",{class:"token operator"},"="),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Set"),n("span",{class:"token punctuation"},";"),n("span",{class:"token keyword"},"return"),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"=>"),s(`
`),n("span",{class:"token punctuation"},"{"),s("n"),n("span",{class:"token operator"},"&&"),s("t"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"add"),n("span",{class:"token punctuation"},"("),s("n"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"=>"),n("span",{class:"token punctuation"},"{"),s("t"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token operator"},"=>"),n("span",{class:"token function"},"e"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"i"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"t"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token keyword"},"let"),n("span",{class:"token punctuation"},"["),s("e"),n("span",{class:"token punctuation"},","),s("r"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token operator"},"="),n("span",{class:"token function"},"f"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),n("span",{class:"token keyword"},"return"),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"=>"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"e"),s(`
`),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s("t"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),n("span",{class:"token parameter"},"c"),n("span",{class:"token operator"},"=>"),n("span",{class:"token punctuation"},"{"),s("t"),n("span",{class:"token operator"},"="),s("c"),n("span",{class:"token punctuation"},","),n("span",{class:"token function"},"r"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"u"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"t"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token keyword"},"let"),n("span",{class:"token punctuation"},"["),s("e"),n("span",{class:"token punctuation"},","),s("r"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token operator"},"="),n("span",{class:"token function"},"i"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token function"},"o"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"=>"),n("span",{class:"token function"},"r"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"t"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s("e"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token keyword"},"export"),n("span",{class:"token punctuation"},"{"),s(`o 
`),n("span",{class:"token keyword"},"as"),s(" effect"),n("span",{class:"token punctuation"},","),s("f "),n("span",{class:"token keyword"},"as"),s(" event"),n("span",{class:"token punctuation"},","),s("u "),n("span",{class:"token keyword"},"as"),s(" memo"),n("span",{class:"token punctuation"},","),s("i "),n("span",{class:"token keyword"},"as"),s(" signal"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("p",null,[s("It\u2019s literally 281 characters. That\u2019s not the 2kb of a tiny library, "),n("em",null,"that\u2019s the 0.2kb of a miniscule library!")]),n("h2",{id:"making-a-render-function",tabindex:"-1"},"Making a render function"),n("p",null,[s("Our first DOM utility will be a "),n("code",{class:""},"render"),s(" function. "),n("code",{class:""},"render"),s(" will be able to render numbers, strings, booleans, signals to those values, and arrays of those values. Our "),n("code",{class:""},"render"),s(" function will take an item to be rendered and a parent node to put the item inside. We\u2019ll also skip over "),n("code",{class:""},"null"),s(" and "),n("code",{class:""},"undefined"),s(" values, as this will help us with conditional rendering in the future. To check "),n("code",{class:""},"null"),s(" and "),n("code",{class:""},"undefined"),s(" at once, we\u2019ll do a loose comparison using "),n("code",{class:""},"=="),s(".")]),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"render"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("item"),n("span",{class:"token punctuation"},","),s(" parent")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("item "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token keyword"},"null"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"return"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"typeof"),s(" item "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token string"},'"function"'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token comment"},"// TODO"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("Array"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"isArray"),n("span",{class:"token punctuation"},"("),s("item"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    item`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"element"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"render"),n("span",{class:"token punctuation"},"("),s("element"),n("span",{class:"token punctuation"},","),s(" parent"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("item "),n("span",{class:"token keyword"},"instanceof"),s(),n("span",{class:"token class-name"},"Node"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    parent`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"append"),n("span",{class:"token punctuation"},"("),s("item"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
    parent`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"append"),n("span",{class:"token punctuation"},"("),s("document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"createTextNode"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"String"),n("span",{class:"token punctuation"},"("),s("item"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("p",null,[s("You might ask, why do we use "),n("code",{class:""},"String(item)"),s(" to convert to a string instead of "),n("code",{class:""},'"" + item'),s("? Well, converting to a string \u201Cexplicitly\u201D stops rendering from breaking if the user passes a symbol. This is because implicitly converting a symbol to a string throws an error.")]),n("p",null,[s("Now, you might be asking why the case for a function was marked with "),n("code",{class:""},"TODO"),s(", even though it would be really easy just to write "),n("code",{class:""},"render(item(), parent)"),s(". Well, the function might be a signal or memo, and we need to reactively observe the function.")]),n("p",null,[s("Before we can do that, we\u2019re going to make a new function called "),n("code",{class:""},"fragment"),s(". "),n("code",{class:""},"fragment"),s(" will allow us to insert DOM nodes into a container without needing a parent element. How will we do that? First, we\u2019ll make a comment node. This is hidden in the HTML, but we can use it as an anchor to place our elements next to.")]),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"fragment"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"parent"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" comment "),n("span",{class:"token operator"},"="),s(" document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"createComment"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'" Fragment "'),n("span",{class:"token punctuation"},")"),s(`
  parent`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"append"),n("span",{class:"token punctuation"},"("),s("comment"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("p",null,[s("That\u2019s great, but how do we actually insert elements, taking into account that they might be arbitrary renderables, such as arrays or functions? Well, we can do a small hack. First, let\u2019s set up "),n("code",{class:""},"fragment"),s(" so that it returns a function which adds renderable items after the comment node.")]),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"fragment"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"parent"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" comment "),n("span",{class:"token operator"},"="),s(" document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"createComment"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'" Fragment "'),n("span",{class:"token punctuation"},")"),s(`
  parent`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"append"),n("span",{class:"token punctuation"},"("),s("comment"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[n("span",{class:"token operator"},"..."),s("items")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token comment"},"// TODO"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("p",null,[s("Now let\u2019s look back at our "),n("code",{class:""},"render"),s(" function. Do you notice how the only DOM method we call is "),n("code",{class:""},".append"),s("? Well, we\u2019re going to make "),n("code",{class:""},"fragment"),s(" send "),n("code",{class:""},"render"),s(" an object that only has a "),n("code",{class:""},".append"),s(" method and nothing else, and we\u2019ll make it so that "),n("code",{class:""},".append"),s(),n("em",null,"actually"),s(" places nodes after the comment.")]),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"fragment"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"parent"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" comment "),n("span",{class:"token operator"},"="),s(" document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"createComment"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'" Fragment "'),n("span",{class:"token punctuation"},")"),s(`
  parent`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"append"),n("span",{class:"token punctuation"},"("),s("comment"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[n("span",{class:"token operator"},"..."),s("items")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token function"},"render"),n("span",{class:"token punctuation"},"("),s("items"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token function"},"append"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"node"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        comment`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"after"),n("span",{class:"token punctuation"},"("),s("node"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("p",null,[s("Now we can use this inside of "),n("code",{class:""},"render"),s("!")]),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"render"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("item"),n("span",{class:"token punctuation"},","),s(" parent")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("item "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token keyword"},"null"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"return"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"typeof"),s(" item "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token string"},'"function"'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" replaceNodes "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"fragment"),n("span",{class:"token punctuation"},"("),s("parent"),n("span",{class:"token punctuation"},")"),s(`

    `),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token function"},"replaceNodes"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"item"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("Array"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"isArray"),n("span",{class:"token punctuation"},"("),s("item"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    item`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"element"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"render"),n("span",{class:"token punctuation"},"("),s("element"),n("span",{class:"token punctuation"},","),s(" parent"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("item "),n("span",{class:"token keyword"},"instanceof"),s(),n("span",{class:"token class-name"},"Node"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    parent`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"append"),n("span",{class:"token punctuation"},"("),s("item"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
    parent`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"append"),n("span",{class:"token punctuation"},"("),s("document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"createTextNode"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"String"),n("span",{class:"token punctuation"},"("),s("item"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("p",null,[s("Except \u2026 there\u2019s a bug. "),n("code",{class:""},"fragment"),s(" doesn\u2019t clear its old items when we call "),n("code",{class:""},"replaceNodes"),s(", so we\u2019ll just end up with duplicates. However, there\u2019s a simple solution to this. We\u2019ll force "),n("code",{class:""},"fragment"),s(" to keep track of anything passed to its "),n("code",{class:""},"append"),s(" function and have it remove those nodes whenever "),n("code",{class:""},"replaceNodes"),s(" is called. We\u2019ll also set its length to "),n("code",{class:""},"0"),s(" before every render, which will clear the array.")]),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"fragment"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"parent"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" comment "),n("span",{class:"token operator"},"="),s(" document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"createComment"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'" Fragment "'),n("span",{class:"token punctuation"},")"),s(`
  parent`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"append"),n("span",{class:"token punctuation"},"("),s("comment"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"let"),s(" appendedNodes "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),s(`

  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[n("span",{class:"token operator"},"..."),s("items")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    appendedNodes`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"node"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      node`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"remove"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

    `),n("span",{class:"token comment"},"// Confused about this syntax? We're just setting an array's length to 0 to"),s(`
    `),n("span",{class:"token comment"},"// delete all its elements without using `.splice`."),s(`
    appendedNodes`),n("span",{class:"token punctuation"},"."),s("length "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"0"),s(`

    `),n("span",{class:"token function"},"render"),n("span",{class:"token punctuation"},"("),s("items"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token comment"},"// This is object method shorthand. It saves us from typing"),s(`
      `),n("span",{class:"token comment"},"// `append: (node) => ...`."),s(`
      `),n("span",{class:"token function"},"append"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"node"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        appendedNodes`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),s("node"),n("span",{class:"token punctuation"},")"),s(`
        comment`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"after"),n("span",{class:"token punctuation"},"("),s("node"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("p",null,"Cool! Now let\u2019s create a utility that sets reactive attributes or properties on an element. We\u2019ll decide whether we should set an attribute or property by checking if a given property exists on the element in question. If it does, we\u2019ll set it. Otherwise, we\u2019ll use a plain attribute."),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"attr"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("element"),n("span",{class:"token punctuation"},","),s(" key"),n("span",{class:"token punctuation"},","),s(" value")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("key "),n("span",{class:"token keyword"},"in"),s(" element"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"typeof"),s(" value "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token string"},'"function"'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
        element`),n("span",{class:"token punctuation"},"["),s("key"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"value"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
      element`),n("span",{class:"token punctuation"},"["),s("key"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(` value
    `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"typeof"),s(" value "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token string"},'"function"'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
        element`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"setAttribute"),n("span",{class:"token punctuation"},"("),s("key"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token function"},"value"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
      element`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"setAttribute"),n("span",{class:"token punctuation"},"("),s("key"),n("span",{class:"token punctuation"},","),s(" value"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("p",null,[s("Now let\u2019s put all the puzzle pieces together and create a function that constructs a DOM element. These are traditionally called "),n("code",{class:""},"h"),s(", which stands for hyperscript.")]),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"h"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("tag"),n("span",{class:"token punctuation"},","),s(" props"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token operator"},"..."),s("children")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" element "),n("span",{class:"token operator"},"="),s(" document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"createElement"),n("span",{class:"token punctuation"},"("),s("tag"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"for"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"const"),s(" key "),n("span",{class:"token keyword"},"in"),s(" props"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token function"},"attr"),n("span",{class:"token punctuation"},"("),s("element"),n("span",{class:"token punctuation"},","),s(" key"),n("span",{class:"token punctuation"},","),s(" props"),n("span",{class:"token punctuation"},"["),s("key"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token function"},"render"),n("span",{class:"token punctuation"},"("),s("children"),n("span",{class:"token punctuation"},","),s(" element"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"return"),s(` element
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("p",null,[s("Notice how our "),n("code",{class:""},"h"),s(" function has the standard signature of "),n("code",{class:""},"React.createElement"),s(". This means it is compatible with almost all JSX transforms, so we can use TypeScript or Babel to compile from JSX into our "),n("code",{class:""},"h"),s(" function.")]),n("p",null,[s("Before we finish with the core framework, let\u2019s make one more function. You may notice that the way we handle signals in a slow way: we create a new "),n("code",{class:""},"Text"),s(" node every time they change. To fix this, we\u2019ll add a helper function called "),n("code",{class:""},"text"),s(" that creates a text node and updates it with the result of a signal.")]),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"text"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"value"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" node "),n("span",{class:"token operator"},"="),s(" document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"createTextNode"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'""'),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"typeof"),s(" value "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token string"},'"function"'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      node`),n("span",{class:"token punctuation"},"."),s("data "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"value"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
    node`),n("span",{class:"token punctuation"},"."),s("data "),n("span",{class:"token operator"},"="),s(` value
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"return"),s(` node
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("p",null,[s("Because our "),n("code",{class:""},"render"),s(" and "),n("code",{class:""},"h"),s(" functions accept "),n("code",{class:""},"Node"),s("s as children, we can call "),n("code",{class:""},"text"),s(" and opt in to a small optimization for our rendering pipeline.")]),n("p",null,[s("Okay, it\u2019s time to put everything together. Let\u2019s "),n("code",{class:""},"export"),s(" all our functions and minify everything. First, I\u2019ll put all of our code here.")]),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"let"),s(` currentEffect

`),n("span",{class:"token keyword"},"export"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"fn"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" parentEffect "),n("span",{class:"token operator"},"="),s(` currentEffect
  currentEffect `),n("span",{class:"token operator"},"="),s(` fn
  `),n("span",{class:"token function"},"fn"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
  currentEffect `),n("span",{class:"token operator"},"="),s(` parentEffect
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"export"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"event"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" tracking "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Set"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"["),s(`
    `),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("currentEffect"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        tracking`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"add"),n("span",{class:"token punctuation"},"("),s("currentEffect"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      tracking`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"effect"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"]"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"export"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"signal"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"value"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("track"),n("span",{class:"token punctuation"},","),s(" trigger"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"event"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"["),s(`
    `),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token function"},"track"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token keyword"},"return"),s(` value
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"newValue"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      value `),n("span",{class:"token operator"},"="),s(` newValue
      `),n("span",{class:"token function"},"trigger"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"]"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"export"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"memo"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"compute"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(),n("span",{class:"token punctuation"},"["),s("get"),n("span",{class:"token punctuation"},","),s(" set"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"signal"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"set"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"compute"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"return"),s(` get
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"export"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"render"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("item"),n("span",{class:"token punctuation"},","),s(" parent")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("item "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token keyword"},"null"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"return"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"typeof"),s(" item "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token string"},'"function"'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" replaceNodes "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"fragment"),n("span",{class:"token punctuation"},"("),s("parent"),n("span",{class:"token punctuation"},")"),s(`

    `),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token function"},"replaceNodes"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"item"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("Array"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"isArray"),n("span",{class:"token punctuation"},"("),s("item"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    item`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"element"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token function"},"render"),n("span",{class:"token punctuation"},"("),s("element"),n("span",{class:"token punctuation"},","),s(" parent"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("item "),n("span",{class:"token keyword"},"instanceof"),s(),n("span",{class:"token class-name"},"Node"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    parent`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"append"),n("span",{class:"token punctuation"},"("),s("item"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
    parent`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"append"),n("span",{class:"token punctuation"},"("),s("document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"createTextNode"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"String"),n("span",{class:"token punctuation"},"("),s("item"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"export"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"fragment"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"parent"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" comment "),n("span",{class:"token operator"},"="),s(" document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"createComment"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'" Fragment "'),n("span",{class:"token punctuation"},")"),s(`
  parent`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"append"),n("span",{class:"token punctuation"},"("),s("comment"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"let"),s(" appendedNodes "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),s(`

  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[n("span",{class:"token operator"},"..."),s("items")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
    appendedNodes`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"node"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      node`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"remove"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`

    appendedNodes`),n("span",{class:"token punctuation"},"."),s("length "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token number"},"0"),s(`

    `),n("span",{class:"token function"},"render"),n("span",{class:"token punctuation"},"("),s("items"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token function"},"append"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"node"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        appendedNodes`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),s("node"),n("span",{class:"token punctuation"},")"),s(`
        comment`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"after"),n("span",{class:"token punctuation"},"("),s("node"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"export"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"attr"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("element"),n("span",{class:"token punctuation"},","),s(" key"),n("span",{class:"token punctuation"},","),s(" value")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("key "),n("span",{class:"token keyword"},"in"),s(" element"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"typeof"),s(" value "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token string"},'"function"'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
        element`),n("span",{class:"token punctuation"},"["),s("key"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"value"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
      element`),n("span",{class:"token punctuation"},"["),s("key"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(` value
    `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"typeof"),s(" value "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token string"},'"function"'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
        element`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"setAttribute"),n("span",{class:"token punctuation"},"("),s("key"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token function"},"value"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
      element`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"setAttribute"),n("span",{class:"token punctuation"},"("),s("key"),n("span",{class:"token punctuation"},","),s(" value"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"export"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"h"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("tag"),n("span",{class:"token punctuation"},","),s(" attributes"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token operator"},"..."),s("children")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" element "),n("span",{class:"token operator"},"="),s(" document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"createElement"),n("span",{class:"token punctuation"},"("),s("tag"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"for"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"const"),s(" key "),n("span",{class:"token keyword"},"in"),s(" attributes"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token function"},"attr"),n("span",{class:"token punctuation"},"("),s("element"),n("span",{class:"token punctuation"},","),s(" key"),n("span",{class:"token punctuation"},","),s(" attributes"),n("span",{class:"token punctuation"},"["),s("key"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token function"},"render"),n("span",{class:"token punctuation"},"("),s("children"),n("span",{class:"token punctuation"},","),s(" element"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"return"),s(` element
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"export"),s(),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"text"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"value"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" node "),n("span",{class:"token operator"},"="),s(" document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"createTextNode"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'""'),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"typeof"),s(" value "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token string"},'"function"'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
      node`),n("span",{class:"token punctuation"},"."),s("data "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"value"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
    node`),n("span",{class:"token punctuation"},"."),s("data "),n("span",{class:"token operator"},"="),s(` value
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"return"),s(` node
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("p",null,"Time to minify! Let\u2019s check it out\u2026"),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"var"),s(" c"),n("span",{class:"token punctuation"},";"),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"f"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"t"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token keyword"},"let"),s(" e"),n("span",{class:"token operator"},"="),s("c"),n("span",{class:"token punctuation"},";"),s("c"),n("span",{class:"token operator"},"="),s("t"),n("span",{class:"token punctuation"},","),n("span",{class:"token function"},"t"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s("c"),n("span",{class:"token operator"},"="),s("e"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"i"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token keyword"},"let"),s(" t"),n("span",{class:"token operator"},"="),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Set"),n("span",{class:"token punctuation"},";"),n("span",{class:"token keyword"},"return"),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"=>"),s(`
`),n("span",{class:"token punctuation"},"{"),s("c"),n("span",{class:"token operator"},"&&"),s("t"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"add"),n("span",{class:"token punctuation"},"("),s("c"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"=>"),n("span",{class:"token punctuation"},"{"),s("t"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token operator"},"=>"),n("span",{class:"token function"},"e"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"p"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"t"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token keyword"},"let"),n("span",{class:"token punctuation"},"["),s("e"),n("span",{class:"token punctuation"},","),s("n"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token operator"},"="),n("span",{class:"token function"},"i"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),n("span",{class:"token keyword"},"return"),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"=>"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"e"),s(`
`),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s("t"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),n("span",{class:"token parameter"},"o"),n("span",{class:"token operator"},"=>"),n("span",{class:"token punctuation"},"{"),s("t"),n("span",{class:"token operator"},"="),s("o"),n("span",{class:"token punctuation"},","),n("span",{class:"token function"},"n"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"a"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"t"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token keyword"},"let"),n("span",{class:"token punctuation"},"["),s("e"),n("span",{class:"token punctuation"},","),s("n"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token operator"},"="),n("span",{class:"token function"},"p"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token function"},"f"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"=>"),n("span",{class:"token function"},"n"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"t"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s("e"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"s"),s(`
`),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("t"),n("span",{class:"token punctuation"},","),s("e")]),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token keyword"},"if"),n("span",{class:"token punctuation"},"("),s("t"),n("span",{class:"token operator"},"!="),n("span",{class:"token keyword"},"null"),n("span",{class:"token punctuation"},")"),n("span",{class:"token keyword"},"if"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"typeof"),s(" t"),n("span",{class:"token operator"},"=="),n("span",{class:"token string"},'"function"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token keyword"},"let"),s(" n"),n("span",{class:"token operator"},"="),n("span",{class:"token function"},"u"),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),n("span",{class:"token function"},"f"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"=>"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token function"},"n"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"t"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token keyword"},"else"),s(" Array"),n("span",{class:"token punctuation"},"."),s(`
`),n("span",{class:"token function"},"isArray"),n("span",{class:"token punctuation"},"("),s("t"),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"?"),s("t"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"n"),n("span",{class:"token operator"},"=>"),n("span",{class:"token function"},"s"),n("span",{class:"token punctuation"},"("),s("n"),n("span",{class:"token punctuation"},","),s("e"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},":"),s("t "),n("span",{class:"token keyword"},"instanceof"),s(),n("span",{class:"token class-name"},"Node"),n("span",{class:"token operator"},"?"),s("e"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"append"),n("span",{class:"token punctuation"},"("),s("t"),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},":"),s("e"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"append"),n("span",{class:"token punctuation"},"("),s("document"),n("span",{class:"token punctuation"},"."),s(`
`),n("span",{class:"token function"},"createTextNode"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"String"),n("span",{class:"token punctuation"},"("),s("t"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"u"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"t"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token keyword"},"let"),s(" e"),n("span",{class:"token operator"},"="),s("document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"createComment"),n("span",{class:"token punctuation"},"("),s(`
`),n("span",{class:"token string"},'" Fragment "'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s("t"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"append"),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),n("span",{class:"token keyword"},"let"),s(" n"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},";"),n("span",{class:"token keyword"},"return"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[n("span",{class:"token operator"},"..."),s("o")]),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"=>"),n("span",{class:"token punctuation"},"{"),s("n"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"r"),n("span",{class:"token operator"},"=>"),n("span",{class:"token punctuation"},"{"),s("r"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"remove"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s("n"),n("span",{class:"token punctuation"},"."),s(`
length`),n("span",{class:"token operator"},"="),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},","),n("span",{class:"token function"},"s"),n("span",{class:"token punctuation"},"("),s("o"),n("span",{class:"token punctuation"},","),n("span",{class:"token punctuation"},"{"),n("span",{class:"token function"},"append"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"r"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),s("n"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),s("r"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s("e"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"after"),n("span",{class:"token punctuation"},"("),s("r"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"d"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("t"),n("span",{class:"token punctuation"},","),s("e"),n("span",{class:"token punctuation"},","),s("n")]),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),s("e "),n("span",{class:"token keyword"},"in"),s(" t"),n("span",{class:"token operator"},"?"),s(`
`),n("span",{class:"token keyword"},"typeof"),s(" n"),n("span",{class:"token operator"},"=="),n("span",{class:"token string"},'"function"'),n("span",{class:"token operator"},"?"),n("span",{class:"token function"},"f"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"=>"),n("span",{class:"token punctuation"},"{"),s("t"),n("span",{class:"token punctuation"},"["),s("e"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token operator"},"="),n("span",{class:"token function"},"n"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},":"),s("t"),n("span",{class:"token punctuation"},"["),s("e"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token operator"},"="),s("n"),n("span",{class:"token operator"},":"),n("span",{class:"token keyword"},"typeof"),s(" n"),n("span",{class:"token operator"},"=="),n("span",{class:"token string"},'"function"'),n("span",{class:"token operator"},"?"),n("span",{class:"token function"},"f"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"=>"),n("span",{class:"token punctuation"},"{"),s("t"),n("span",{class:"token punctuation"},"."),s(`
`),n("span",{class:"token function"},"setAttribute"),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},","),n("span",{class:"token function"},"n"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},":"),s("t"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"setAttribute"),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},","),s("n"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"x"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("t"),n("span",{class:"token punctuation"},","),s("e"),n("span",{class:"token punctuation"},","),n("span",{class:"token operator"},"..."),s("n")]),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token keyword"},"let"),s(" o"),n("span",{class:"token operator"},"="),s("document"),n("span",{class:"token punctuation"},"."),s(`
`),n("span",{class:"token function"},"createElement"),n("span",{class:"token punctuation"},"("),s("t"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),n("span",{class:"token keyword"},"for"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"let"),s(" r "),n("span",{class:"token keyword"},"in"),s(" e"),n("span",{class:"token punctuation"},")"),n("span",{class:"token function"},"d"),n("span",{class:"token punctuation"},"("),s("o"),n("span",{class:"token punctuation"},","),s("r"),n("span",{class:"token punctuation"},","),s("e"),n("span",{class:"token punctuation"},"["),s("r"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token function"},"s"),n("span",{class:"token punctuation"},"("),s("n"),n("span",{class:"token punctuation"},","),s("o"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s("o"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"g"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"t"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token keyword"},"let"),s(` 
e`),n("span",{class:"token operator"},"="),s("document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"createTextNode"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'""'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token keyword"},"typeof"),s(" t"),n("span",{class:"token operator"},"=="),n("span",{class:"token string"},'"function"'),n("span",{class:"token operator"},"?"),n("span",{class:"token function"},"f"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"=>"),n("span",{class:"token punctuation"},"{"),s("e"),n("span",{class:"token punctuation"},"."),s("data"),n("span",{class:"token operator"},"="),n("span",{class:"token function"},"t"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},":"),s("e"),n("span",{class:"token punctuation"},"."),s(`
data`),n("span",{class:"token operator"},"="),s("t"),n("span",{class:"token punctuation"},","),s("e"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token keyword"},"export"),n("span",{class:"token punctuation"},"{"),s("d "),n("span",{class:"token keyword"},"as"),s(" attr"),n("span",{class:"token punctuation"},","),s("f "),n("span",{class:"token keyword"},"as"),s(" effect"),n("span",{class:"token punctuation"},","),s("i "),n("span",{class:"token keyword"},"as"),s(" event"),n("span",{class:"token punctuation"},","),s("u "),n("span",{class:"token keyword"},"as"),s(" fragment"),n("span",{class:"token punctuation"},","),s("x "),n("span",{class:"token keyword"},"as"),s(" h"),n("span",{class:"token punctuation"},","),s("a "),n("span",{class:"token keyword"},"as"),s(" memo"),n("span",{class:"token punctuation"},","),s(`
s `),n("span",{class:"token keyword"},"as"),s(" render"),n("span",{class:"token punctuation"},","),s("p "),n("span",{class:"token keyword"},"as"),s(" signal"),n("span",{class:"token punctuation"},","),s("g "),n("span",{class:"token keyword"},"as"),s(" text"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("p",null,"It\u2019s just over a kilobyte, at 1047 bytes. And we\u2019ve got a fully functioning fine-grained reactivity library that has complete DOM support! It makes you wonder how the React team gets along with 100kb projects."),n("h2",{id:"bonus-features",tabindex:"-1"},"Bonus features"),n("p",null,[s("Now that the core framework is done, let\u2019s add some "),n("em",null,"bonus features"),s(". First of all, we should be able to organize our code into components. A component will basically be a function that takes props. We could call them manually, but we want them to be compatible with a JSX transform, so let\u2019s add support for them into "),n("code",{class:""},"h"),s(".")]),n("p",null,"First, I\u2019ll model an example component."),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"FancyButton"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[n("span",{class:"token punctuation"},"{"),s(" children "),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token function"},"h"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"button"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token literal-property property"},"style"),n("span",{class:"token operator"},":"),s(`
      `),n("span",{class:"token string"},'"border: 1px solid black; background-color: white; font-size: inherit"'),n("span",{class:"token punctuation"},","),s(`
    children`),n("span",{class:"token punctuation"},","),s(`
  `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token keyword"},"const"),s(" myButton "),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"h"),n("span",{class:"token punctuation"},"("),s("FancyButton"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"null"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},'"some content"'),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("p",null,[s("First, let\u2019s allow users to pass a "),n("code",{class:""},"children"),s(" prop to "),n("code",{class:""},"h"),s(". That\u2019s easy: we just need to check if "),n("code",{class:""},"children"),s(" exists in our attributes list.")]),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"h"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("tag"),n("span",{class:"token punctuation"},","),s(" props"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token operator"},"..."),s("children")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  `),n("span",{class:"token keyword"},"const"),s(" element "),n("span",{class:"token operator"},"="),s(" document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"createElement"),n("span",{class:"token punctuation"},"("),s("tag"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"children"'),s(),n("span",{class:"token keyword"},"in"),s(" props"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    children `),n("span",{class:"token operator"},"="),s(" props"),n("span",{class:"token punctuation"},"."),s(`children
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"for"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"const"),s(" key "),n("span",{class:"token keyword"},"in"),s(" props"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token function"},"attr"),n("span",{class:"token punctuation"},"("),s("element"),n("span",{class:"token punctuation"},","),s(" key"),n("span",{class:"token punctuation"},","),s(" props"),n("span",{class:"token punctuation"},"["),s("key"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token function"},"render"),n("span",{class:"token punctuation"},"("),s("children"),n("span",{class:"token punctuation"},","),s(" element"),n("span",{class:"token punctuation"},")"),s(`

  `),n("span",{class:"token keyword"},"return"),s(` element
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("p",null,[s("The second task is slightly more difficult. Components have different signatures for the "),n("code",{class:""},"children"),s(" prop, as it might be "),n("code",{class:""},"undefined"),s(", a single item, or an array of items.")]),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"MyComponent"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[n("span",{class:"token punctuation"},"{"),s(" children "),n("span",{class:"token punctuation"},"}")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"}"),s(`

`),n("span",{class:"token comment"},"// When no children are passed, `MyComponent` should receive `undefined`."),s(`
`),n("span",{class:"token function"},"h"),n("span",{class:"token punctuation"},"("),s("MyComponent"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"null"),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// If one child is passed, `MyComponent` should get that item (not an array)."),s(`
`),n("span",{class:"token function"},"h"),n("span",{class:"token punctuation"},"("),s("MyComponent"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"null"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},'"zSnout"'),n("span",{class:"token punctuation"},")"),s(`

`),n("span",{class:"token comment"},"// If multiple are passed, `MyComponent` should receive an array of children."),s(`
`),n("span",{class:"token function"},"h"),n("span",{class:"token punctuation"},"("),s("MyComponent"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token keyword"},"null"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},'"Content #1"'),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token string"},'"Content #2"'),n("span",{class:"token punctuation"},")"),s(`
`)])]),n("p",null,[s("However, we can just check the length of the "),n("code",{class:""},"children"),s(" parameter. We\u2019ll also assume that, if it is passed, the "),n("code",{class:""},"children"),s(" prop already has the correct type. Note that we also have to reverse this process when creating DOM nodes. We\u2019ll also add a safety check to make sure "),n("code",{class:""},"props"),s(" is an object, as if it was a primitive, a lot of things would break.")]),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"h"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("tag"),n("span",{class:"token punctuation"},","),s(" props"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token operator"},"..."),s("children")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  props `),n("span",{class:"token operator"},"??="),s(),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"typeof"),s(" tag "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token string"},'"function"'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"children"'),s(),n("span",{class:"token keyword"},"in"),s(" props"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      children `),n("span",{class:"token operator"},"="),s(" props"),n("span",{class:"token punctuation"},"."),s(`children
    `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("children"),n("span",{class:"token punctuation"},"."),s("length "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      children `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"undefined"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("children"),n("span",{class:"token punctuation"},"."),s("length "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      children `),n("span",{class:"token operator"},"="),s(" children"),n("span",{class:"token punctuation"},"["),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},"]"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`

    `),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token function"},"tag"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token operator"},"..."),s("props"),n("span",{class:"token punctuation"},","),s(" children "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"const"),s(" element "),n("span",{class:"token operator"},"="),s(" document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"createElement"),n("span",{class:"token punctuation"},"("),s("tag"),n("span",{class:"token punctuation"},")"),s(`

    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"children"'),s(),n("span",{class:"token keyword"},"in"),s(" props"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token comment"},"// This section reverses the effect of changing `props.children`."),s(`

      `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("props"),n("span",{class:"token punctuation"},"."),s("children "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token keyword"},"null"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        children `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),s(`
      `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("Array"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"isArray"),n("span",{class:"token punctuation"},"("),s("props"),n("span",{class:"token punctuation"},"."),s("children"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        children `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),s("props"),n("span",{class:"token punctuation"},"."),s("children"),n("span",{class:"token punctuation"},"]"),s(`
      `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
        children `),n("span",{class:"token operator"},"="),s(" props"),n("span",{class:"token punctuation"},"."),s(`children
      `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`

    `),n("span",{class:"token keyword"},"for"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"const"),s(" key "),n("span",{class:"token keyword"},"in"),s(" props"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token function"},"attr"),n("span",{class:"token punctuation"},"("),s("element"),n("span",{class:"token punctuation"},","),s(" key"),n("span",{class:"token punctuation"},","),s(" props"),n("span",{class:"token punctuation"},"["),s("key"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`

    `),n("span",{class:"token function"},"render"),n("span",{class:"token punctuation"},"("),s("children"),n("span",{class:"token punctuation"},","),s(" element"),n("span",{class:"token punctuation"},")"),s(`

    `),n("span",{class:"token keyword"},"return"),s(` element
  `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("p",null,"Our function is certainly much heftier now, but it can render components properly, so that\u2019s a plus. However, we\u2019re still missing many things, including event handling, CSS styles, and class toggling. Let\u2019s add a few of those."),n("p",null,[s("For event handling, we\u2019ll use props that start with "),n("code",{class:""},"on:"),s("; for CSS properties, we\u2019ll use "),n("code",{class:""},"style:"),s("; and for classes, we\u2019ll use "),n("code",{class:""},"class:"),s(". We\u2019ll also add a special "),n("code",{class:""},"use"),s(" prop that calls a function with the created node. Since all of these should work whether we\u2019re creating a component or a DOM element, let\u2019s start by extracting the element returned from our "),n("code",{class:""},"if-else"),s(" statement. We\u2019ll also stop passing props with a "),n("code",{class:""},":"),s(" in them to created DOM nodes.")]),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"h"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("tag"),n("span",{class:"token punctuation"},","),s(" props"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token operator"},"..."),s("children")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  props `),n("span",{class:"token operator"},"??="),s(),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"let"),s(` element

  `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"typeof"),s(" tag "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token string"},'"function"'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"children"'),s(),n("span",{class:"token keyword"},"in"),s(" props"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      children `),n("span",{class:"token operator"},"="),s(" props"),n("span",{class:"token punctuation"},"."),s(`children
    `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("children"),n("span",{class:"token punctuation"},"."),s("length "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      children `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"undefined"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("children"),n("span",{class:"token punctuation"},"."),s("length "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      children `),n("span",{class:"token operator"},"="),s(" children"),n("span",{class:"token punctuation"},"["),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},"]"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`

    element `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"tag"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token operator"},"..."),s("props"),n("span",{class:"token punctuation"},","),s(" children "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
    element `),n("span",{class:"token operator"},"="),s(" document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"createElement"),n("span",{class:"token punctuation"},"("),s("tag"),n("span",{class:"token punctuation"},")"),s(`

    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"children"'),s(),n("span",{class:"token keyword"},"in"),s(" props"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("props"),n("span",{class:"token punctuation"},"."),s("children "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token keyword"},"null"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        children `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),s(`
      `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("Array"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"isArray"),n("span",{class:"token punctuation"},"("),s("props"),n("span",{class:"token punctuation"},"."),s("children"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        children `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),s("props"),n("span",{class:"token punctuation"},"."),s("children"),n("span",{class:"token punctuation"},"]"),s(`
      `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
        children `),n("span",{class:"token operator"},"="),s(" props"),n("span",{class:"token punctuation"},"."),s(`children
      `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`

    `),n("span",{class:"token keyword"},"for"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"const"),s(" key "),n("span",{class:"token keyword"},"in"),s(" props"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),n("span",{class:"token punctuation"},"("),s("key"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"includes"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'":"'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"||"),s(" key "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token string"},'"use"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token function"},"attr"),n("span",{class:"token punctuation"},"("),s("element"),n("span",{class:"token punctuation"},","),s(" key"),n("span",{class:"token punctuation"},","),s(" props"),n("span",{class:"token punctuation"},"["),s("key"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`

    `),n("span",{class:"token function"},"render"),n("span",{class:"token punctuation"},"("),s("children"),n("span",{class:"token punctuation"},","),s(" element"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"return"),s(` element
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("p",null,"Perfect. Now we\u2019ll just add special handling for the props we listed above."),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"h"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("tag"),n("span",{class:"token punctuation"},","),s(" props"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token operator"},"..."),s("children")]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
  props `),n("span",{class:"token operator"},"??="),s(),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"let"),s(` element

  `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"typeof"),s(" tag "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token string"},'"function"'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"children"'),s(),n("span",{class:"token keyword"},"in"),s(" props"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      children `),n("span",{class:"token operator"},"="),s(" props"),n("span",{class:"token punctuation"},"."),s(`children
    `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("children"),n("span",{class:"token punctuation"},"."),s("length "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      children `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token keyword"},"undefined"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("children"),n("span",{class:"token punctuation"},"."),s("length "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      children `),n("span",{class:"token operator"},"="),s(" children"),n("span",{class:"token punctuation"},"["),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},"]"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`

    element `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"tag"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token operator"},"..."),s("props"),n("span",{class:"token punctuation"},","),s(" children "),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
    element `),n("span",{class:"token operator"},"="),s(" document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"createElement"),n("span",{class:"token punctuation"},"("),s("tag"),n("span",{class:"token punctuation"},")"),s(`

    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"children"'),s(),n("span",{class:"token keyword"},"in"),s(" props"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("props"),n("span",{class:"token punctuation"},"."),s("children "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token keyword"},"null"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        children `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),s(`
      `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),s("Array"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"isArray"),n("span",{class:"token punctuation"},"("),s("props"),n("span",{class:"token punctuation"},"."),s("children"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        children `),n("span",{class:"token operator"},"="),s(),n("span",{class:"token punctuation"},"["),s("props"),n("span",{class:"token punctuation"},"."),s("children"),n("span",{class:"token punctuation"},"]"),s(`
      `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
        children `),n("span",{class:"token operator"},"="),s(" props"),n("span",{class:"token punctuation"},"."),s(`children
      `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`

    `),n("span",{class:"token keyword"},"for"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"const"),s(" key "),n("span",{class:"token keyword"},"in"),s(" props"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token operator"},"!"),n("span",{class:"token punctuation"},"("),s("key"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"includes"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'":"'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"||"),s(" key "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token string"},'"use"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token function"},"attr"),n("span",{class:"token punctuation"},"("),s("element"),n("span",{class:"token punctuation"},","),s(" key"),n("span",{class:"token punctuation"},","),s(" props"),n("span",{class:"token punctuation"},"["),s("key"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`

    `),n("span",{class:"token function"},"render"),n("span",{class:"token punctuation"},"("),s("children"),n("span",{class:"token punctuation"},","),s(" element"),n("span",{class:"token punctuation"},")"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"for"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"const"),s(" key "),n("span",{class:"token keyword"},"in"),s(" props"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("key "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token string"},'"use"'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      props`),n("span",{class:"token punctuation"},"["),s("key"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},"("),s("element"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("key"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"startsWith"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"class:"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token keyword"},"const"),s(" value "),n("span",{class:"token operator"},"="),s(" props"),n("span",{class:"token punctuation"},"["),s("key"),n("span",{class:"token punctuation"},"]"),s(`

      `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"typeof"),s(" value "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token string"},'"function"'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
          element`),n("span",{class:"token punctuation"},"."),s("classList"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"toggle"),n("span",{class:"token punctuation"},"("),s("key"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"slice"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"6"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token operator"},"!"),n("span",{class:"token operator"},"!"),n("span",{class:"token function"},"value"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
        element`),n("span",{class:"token punctuation"},"."),s("classList"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"toggle"),n("span",{class:"token punctuation"},"("),s("key"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"slice"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"6"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(),n("span",{class:"token operator"},"!"),n("span",{class:"token operator"},"!"),s("value"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("key"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"startsWith"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"on:"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      element`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"addEventListener"),n("span",{class:"token punctuation"},"("),s("key"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"slice"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"3"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(" props"),n("span",{class:"token punctuation"},"["),s("key"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),s("key"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"startsWith"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"style:"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
      `),n("span",{class:"token keyword"},"const"),s(" value "),n("span",{class:"token operator"},"="),s(" props"),n("span",{class:"token punctuation"},"["),s("key"),n("span",{class:"token punctuation"},"]"),s(`

      `),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"typeof"),s(" value "),n("span",{class:"token operator"},"=="),s(),n("span",{class:"token string"},'"function"'),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
        `),n("span",{class:"token function"},"effect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token operator"},"=>"),s(),n("span",{class:"token punctuation"},"{"),s(`
          element`),n("span",{class:"token punctuation"},"."),s("style"),n("span",{class:"token punctuation"},"["),s("key"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"slice"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"6"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token function"},"value"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),s(`
      `),n("span",{class:"token punctuation"},"}"),s(),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token punctuation"},"{"),s(`
        element`),n("span",{class:"token punctuation"},"."),s("style"),n("span",{class:"token punctuation"},"["),s("key"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"slice"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"6"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"]"),s(),n("span",{class:"token operator"},"="),s(` value
      `),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
  `),n("span",{class:"token punctuation"},"}"),s(`

  `),n("span",{class:"token keyword"},"return"),s(` element
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("p",null,[s("Great! It\u2019s time to minify everything, so let\u2019s pop our new "),n("code",{class:""},"h"),s(" function into esbuild and get the "),n("em",null,"1.6 kilobyte"),s(" result.")]),n("pre",{class:"language-js"},[n("code",{class:"language-js"},[n("span",{class:"token keyword"},"var"),s(" s"),n("span",{class:"token punctuation"},";"),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"o"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"t"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token keyword"},"let"),s(" e"),n("span",{class:"token operator"},"="),s("s"),n("span",{class:"token punctuation"},";"),s("s"),n("span",{class:"token operator"},"="),s("t"),n("span",{class:"token punctuation"},","),n("span",{class:"token function"},"t"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s("s"),n("span",{class:"token operator"},"="),s("e"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"l"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token keyword"},"let"),s(" t"),n("span",{class:"token operator"},"="),n("span",{class:"token keyword"},"new"),s(),n("span",{class:"token class-name"},"Set"),n("span",{class:"token punctuation"},";"),n("span",{class:"token keyword"},"return"),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"=>"),s(`
`),n("span",{class:"token punctuation"},"{"),s("s"),n("span",{class:"token operator"},"&&"),s("t"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"add"),n("span",{class:"token punctuation"},"("),s("s"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},","),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"=>"),n("span",{class:"token punctuation"},"{"),s("t"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"e"),n("span",{class:"token operator"},"=>"),n("span",{class:"token function"},"e"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"u"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"t"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token keyword"},"let"),n("span",{class:"token punctuation"},"["),s("e"),n("span",{class:"token punctuation"},","),s("n"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token operator"},"="),n("span",{class:"token function"},"l"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),n("span",{class:"token keyword"},"return"),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"=>"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"e"),s(`
`),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s("t"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),n("span",{class:"token parameter"},"i"),n("span",{class:"token operator"},"=>"),n("span",{class:"token punctuation"},"{"),s("t"),n("span",{class:"token operator"},"="),s("i"),n("span",{class:"token punctuation"},","),n("span",{class:"token function"},"n"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"g"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"t"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token keyword"},"let"),n("span",{class:"token punctuation"},"["),s("e"),n("span",{class:"token punctuation"},","),s("n"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token operator"},"="),n("span",{class:"token function"},"u"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token function"},"o"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"=>"),n("span",{class:"token function"},"n"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"t"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s("e"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"r"),s(`
`),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("t"),n("span",{class:"token punctuation"},","),s("e")]),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token keyword"},"if"),n("span",{class:"token punctuation"},"("),s("t"),n("span",{class:"token operator"},"!="),n("span",{class:"token keyword"},"null"),n("span",{class:"token punctuation"},")"),n("span",{class:"token keyword"},"if"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"typeof"),s(" t"),n("span",{class:"token operator"},"=="),n("span",{class:"token string"},'"function"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token keyword"},"let"),s(" n"),n("span",{class:"token operator"},"="),n("span",{class:"token function"},"a"),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),n("span",{class:"token function"},"o"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"=>"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token function"},"n"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"t"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token keyword"},"else"),s(" Array"),n("span",{class:"token punctuation"},"."),s(`
`),n("span",{class:"token function"},"isArray"),n("span",{class:"token punctuation"},"("),s("t"),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"?"),s("t"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"n"),n("span",{class:"token operator"},"=>"),n("span",{class:"token function"},"r"),n("span",{class:"token punctuation"},"("),s("n"),n("span",{class:"token punctuation"},","),s("e"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},":"),s("t "),n("span",{class:"token keyword"},"instanceof"),s(),n("span",{class:"token class-name"},"Node"),n("span",{class:"token operator"},"?"),s("e"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"append"),n("span",{class:"token punctuation"},"("),s("t"),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},":"),s("e"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"append"),n("span",{class:"token punctuation"},"("),s("document"),n("span",{class:"token punctuation"},"."),s(`
`),n("span",{class:"token function"},"createTextNode"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"String"),n("span",{class:"token punctuation"},"("),s("t"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"a"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"t"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token keyword"},"let"),s(" e"),n("span",{class:"token operator"},"="),s("document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"createComment"),n("span",{class:"token punctuation"},"("),s(`
`),n("span",{class:"token string"},'" Fragment "'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),s("t"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"append"),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),n("span",{class:"token keyword"},"let"),s(" n"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},";"),n("span",{class:"token keyword"},"return"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[n("span",{class:"token operator"},"..."),s("i")]),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"=>"),n("span",{class:"token punctuation"},"{"),s("n"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"forEach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"f"),n("span",{class:"token operator"},"=>"),n("span",{class:"token punctuation"},"{"),s("f"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"remove"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s("n"),n("span",{class:"token punctuation"},"."),s(`
length`),n("span",{class:"token operator"},"="),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},","),n("span",{class:"token function"},"r"),n("span",{class:"token punctuation"},"("),s("i"),n("span",{class:"token punctuation"},","),n("span",{class:"token punctuation"},"{"),n("span",{class:"token function"},"append"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"f"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),s("n"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"push"),n("span",{class:"token punctuation"},"("),s("f"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s("e"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"after"),n("span",{class:"token punctuation"},"("),s("f"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"d"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("t"),n("span",{class:"token punctuation"},","),s("e"),n("span",{class:"token punctuation"},","),s("n")]),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),s("e "),n("span",{class:"token keyword"},"in"),s(" t"),n("span",{class:"token operator"},"?"),s(`
`),n("span",{class:"token keyword"},"typeof"),s(" n"),n("span",{class:"token operator"},"=="),n("span",{class:"token string"},'"function"'),n("span",{class:"token operator"},"?"),n("span",{class:"token function"},"o"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"=>"),n("span",{class:"token punctuation"},"{"),s("t"),n("span",{class:"token punctuation"},"["),s("e"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token operator"},"="),n("span",{class:"token function"},"n"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},":"),s("t"),n("span",{class:"token punctuation"},"["),s("e"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token operator"},"="),s("n"),n("span",{class:"token operator"},":"),n("span",{class:"token keyword"},"typeof"),s(" n"),n("span",{class:"token operator"},"=="),n("span",{class:"token string"},'"function"'),n("span",{class:"token operator"},"?"),n("span",{class:"token function"},"o"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"=>"),n("span",{class:"token punctuation"},"{"),s("t"),n("span",{class:"token punctuation"},"."),s(`
`),n("span",{class:"token function"},"setAttribute"),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},","),n("span",{class:"token function"},"n"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},":"),s("t"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"setAttribute"),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},","),s("n"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"x"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},[s("t"),n("span",{class:"token punctuation"},","),s("e"),n("span",{class:"token punctuation"},","),n("span",{class:"token operator"},"..."),s("n")]),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),s("e"),n("span",{class:"token operator"},"??="),n("span",{class:"token punctuation"},"{"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},";"),n("span",{class:"token keyword"},"let"),s(" i"),n("span",{class:"token punctuation"},";"),n("span",{class:"token keyword"},"if"),s(`
`),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"typeof"),s(" t"),n("span",{class:"token operator"},"=="),n("span",{class:"token string"},'"function"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token string"},'"children"'),n("span",{class:"token keyword"},"in"),s(" e"),n("span",{class:"token operator"},"?"),s("n"),n("span",{class:"token operator"},"="),s("e"),n("span",{class:"token punctuation"},"."),s("children"),n("span",{class:"token operator"},":"),s("n"),n("span",{class:"token punctuation"},"."),s("length"),n("span",{class:"token operator"},"=="),n("span",{class:"token number"},"0"),n("span",{class:"token operator"},"?"),s("n"),n("span",{class:"token operator"},"="),n("span",{class:"token keyword"},"void"),s(),n("span",{class:"token number"},"0"),n("span",{class:"token operator"},":"),s("n"),n("span",{class:"token punctuation"},"."),s(`
length`),n("span",{class:"token operator"},"=="),n("span",{class:"token number"},"1"),n("span",{class:"token operator"},"&&"),n("span",{class:"token punctuation"},"("),s("n"),n("span",{class:"token operator"},"="),s("n"),n("span",{class:"token punctuation"},"["),n("span",{class:"token number"},"0"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s("i"),n("span",{class:"token operator"},"="),n("span",{class:"token function"},"t"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"{"),n("span",{class:"token operator"},"..."),s("e"),n("span",{class:"token punctuation"},","),n("span",{class:"token literal-property property"},"children"),n("span",{class:"token operator"},":"),s("n"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),n("span",{class:"token keyword"},"else"),n("span",{class:"token punctuation"},"{"),s("i"),n("span",{class:"token operator"},"="),s("document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"createElement"),n("span",{class:"token punctuation"},"("),s("t"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s(`
`),n("span",{class:"token string"},'"children"'),n("span",{class:"token keyword"},"in"),s(" e"),n("span",{class:"token operator"},"&&"),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},"."),s("children"),n("span",{class:"token operator"},"=="),n("span",{class:"token keyword"},"null"),n("span",{class:"token operator"},"?"),s("n"),n("span",{class:"token operator"},"="),n("span",{class:"token punctuation"},"["),n("span",{class:"token punctuation"},"]"),n("span",{class:"token operator"},":"),s("Array"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"isArray"),n("span",{class:"token punctuation"},"("),s("e"),n("span",{class:"token punctuation"},"."),s("children"),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"?"),s("n"),n("span",{class:"token operator"},"="),s("e"),n("span",{class:"token punctuation"},"."),s("children"),n("span",{class:"token operator"},":"),s("n"),n("span",{class:"token operator"},"="),s(`
`),n("span",{class:"token punctuation"},"["),s("e"),n("span",{class:"token punctuation"},"."),s("children"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),n("span",{class:"token keyword"},"for"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"let"),s(" f "),n("span",{class:"token keyword"},"in"),s(" e"),n("span",{class:"token punctuation"},")"),s("f"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"includes"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'":"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"||"),s("f"),n("span",{class:"token operator"},"=="),n("span",{class:"token string"},'"use"'),n("span",{class:"token operator"},"||"),n("span",{class:"token function"},"d"),n("span",{class:"token punctuation"},"("),s("i"),n("span",{class:"token punctuation"},","),s("f"),n("span",{class:"token punctuation"},","),s("e"),n("span",{class:"token punctuation"},"["),s("f"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),n("span",{class:"token function"},"r"),n("span",{class:"token punctuation"},"("),s("n"),n("span",{class:"token punctuation"},","),s("i"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token keyword"},"for"),s(`
`),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"let"),s(" f "),n("span",{class:"token keyword"},"in"),s(" e"),n("span",{class:"token punctuation"},")"),n("span",{class:"token keyword"},"if"),n("span",{class:"token punctuation"},"("),s("f"),n("span",{class:"token operator"},"=="),n("span",{class:"token string"},'"use"'),n("span",{class:"token punctuation"},")"),s("e"),n("span",{class:"token punctuation"},"["),s("f"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},"("),s("i"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),n("span",{class:"token punctuation"},"("),s("f"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"startsWith"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"class:"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token keyword"},"let"),s(" c"),n("span",{class:"token operator"},"="),s("e"),n("span",{class:"token punctuation"},"["),s("f"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},";"),s(`
`),n("span",{class:"token keyword"},"typeof"),s(" c"),n("span",{class:"token operator"},"=="),n("span",{class:"token string"},'"function"'),n("span",{class:"token operator"},"?"),n("span",{class:"token function"},"o"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"=>"),n("span",{class:"token punctuation"},"{"),s("i"),n("span",{class:"token punctuation"},"."),s("classList"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"toggle"),n("span",{class:"token punctuation"},"("),s("f"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"slice"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"6"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),n("span",{class:"token operator"},"!"),n("span",{class:"token operator"},"!"),n("span",{class:"token function"},"c"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},":"),s("i"),n("span",{class:"token punctuation"},"."),s("classList"),n("span",{class:"token punctuation"},"."),s(`
`),n("span",{class:"token function"},"toggle"),n("span",{class:"token punctuation"},"("),s("f"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"slice"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"6"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),n("span",{class:"token operator"},"!"),n("span",{class:"token operator"},"!"),s("c"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),n("span",{class:"token punctuation"},"("),s("f"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"startsWith"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"on:"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s("i"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"addEventListener"),n("span",{class:"token punctuation"},"("),s("f"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"slice"),s(`
`),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"3"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},","),s("e"),n("span",{class:"token punctuation"},"["),s("f"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),n("span",{class:"token keyword"},"else"),s(),n("span",{class:"token keyword"},"if"),n("span",{class:"token punctuation"},"("),s("f"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"startsWith"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'"style:"'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token keyword"},"let"),s(" c"),n("span",{class:"token operator"},"="),s("e"),n("span",{class:"token punctuation"},"["),s("f"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},";"),n("span",{class:"token keyword"},"typeof"),s(" c"),n("span",{class:"token operator"},"=="),n("span",{class:"token string"},'"function"'),n("span",{class:"token operator"},"?"),n("span",{class:"token function"},"o"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"=>"),s(`
`),n("span",{class:"token punctuation"},"{"),s("i"),n("span",{class:"token punctuation"},"."),s("style"),n("span",{class:"token punctuation"},"["),s("f"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"slice"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"6"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token operator"},"="),n("span",{class:"token function"},"c"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},":"),s("i"),n("span",{class:"token punctuation"},"."),s("style"),n("span",{class:"token punctuation"},"["),s("f"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"slice"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"6"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"]"),n("span",{class:"token operator"},"="),s("c"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token keyword"},"return"),s(" i"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token keyword"},"function"),s(),n("span",{class:"token function"},"y"),n("span",{class:"token punctuation"},"("),n("span",{class:"token parameter"},"t"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),n("span",{class:"token keyword"},"let"),s(` 
e`),n("span",{class:"token operator"},"="),s("document"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"createTextNode"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string"},'""'),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},";"),n("span",{class:"token keyword"},"return"),s(),n("span",{class:"token keyword"},"typeof"),s(" t"),n("span",{class:"token operator"},"=="),n("span",{class:"token string"},'"function"'),n("span",{class:"token operator"},"?"),n("span",{class:"token function"},"o"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},"=>"),n("span",{class:"token punctuation"},"{"),s("e"),n("span",{class:"token punctuation"},"."),s("data"),n("span",{class:"token operator"},"="),n("span",{class:"token function"},"t"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},")"),n("span",{class:"token operator"},":"),s("e"),n("span",{class:"token punctuation"},"."),s(`
data`),n("span",{class:"token operator"},"="),s("t"),n("span",{class:"token punctuation"},","),s("e"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token keyword"},"export"),n("span",{class:"token punctuation"},"{"),s("d "),n("span",{class:"token keyword"},"as"),s(" attr"),n("span",{class:"token punctuation"},","),s("o "),n("span",{class:"token keyword"},"as"),s(" effect"),n("span",{class:"token punctuation"},","),s("l "),n("span",{class:"token keyword"},"as"),s(" event"),n("span",{class:"token punctuation"},","),s("a "),n("span",{class:"token keyword"},"as"),s(" fragment"),n("span",{class:"token punctuation"},","),s("x "),n("span",{class:"token keyword"},"as"),s(" h"),n("span",{class:"token punctuation"},","),s("g "),n("span",{class:"token keyword"},"as"),s(" memo"),n("span",{class:"token punctuation"},","),s(`
r `),n("span",{class:"token keyword"},"as"),s(" render"),n("span",{class:"token punctuation"},","),s("u "),n("span",{class:"token keyword"},"as"),s(" signal"),n("span",{class:"token punctuation"},","),s("y "),n("span",{class:"token keyword"},"as"),s(" text"),n("span",{class:"token punctuation"},"}"),n("span",{class:"token punctuation"},";"),s(`
`)])]),n("p",null,"Done! We now have a complete web framework. It\u2019s also a much faster framework than something like React or Vue."),n("h2",{id:"measuring-performance",tabindex:"-1"},"Measuring performance"),n("p",null,"What? How can our tiny library be faster than the longest-living, most used, and largest web frameworks of all time? Well, React and Vue operate using something called the virtual DOM. Basically, if some state, such as a prop, hook, ref, or store, React and Vue will re-run all of your components. You might think that re-creating all of those DOM elements is an expensive operation, and it is."),n("p",null,[s("However, React and Vue have an optimization here and create a virtual representation of the DOM, which is also known as a virtual DOM. Then, these frameworks will look for any differences between the current virtual DOM and the previous one, and apply these changes. Don\u2019t get me wrong: this is much faster than setting "),n("code",{class:""},"document.body.innerHTML"),s(" or re-creating all the DOM elements. But instead of checking which part needs to be changed, why don\u2019t we just have the developer tell you?")]),n("p",null,"Well, that\u2019s what our framework does. We use signals and memos that update things that depend on their values, not every effect in existence. And by encapsulating anything that updates the DOM in an effect, we effectively only update parts of the DOM that need updating, just without an expensive virtual DOM."),n("p",null,[s("This type of a system is called "),n("em",null,"fine-grained reactivity"),s(", which is a concise way of saying that we only update things that need to be updated, instead of updating the entire DOM. It\u2019s a very efficient system and the benchmarks prove it.")]),n("h2",{id:"conclusion",tabindex:"-1"},"Conclusion"),n("p",null,"Hopefully you learned something new about JavaScript frameworks today. You can even take this knowledge into your next job interview, as your interviewer will definitely be impressed if you write a JS framework from scratch in front of their eyes. Just make sure to put your own spin on it, or they\u2019ll accuse you of copying Solid or Willow!"),n("p",null,"For those of you who want to improve on our script, here are a few areas that still need work on."),n("ul",null,[n("li",null,[n("p",null,[n("strong",null,"Efficient lists:"),s(" Currently, rendering lists takes a lot of work with our software, as we\u2019d use a memo combined with "),n("code",{class:""},"Array.map"),s(", which would recreate each node every time we updated the underlying array. Can you come up with a better implementation that reuses existing nodes?")])]),n("li",null,[n("p",null,[n("strong",null,"Conditional blocks:"),s(" So far, the best way to create conditional blocks would be to use the ternary operator. Can you create a component to abstract this? Think about Vue\u2019s "),n("code",{class:""},"v-if"),s(" directive or Solid\u2019s "),n("code",{class:""},"Show"),s(" component.")])]),n("li",null,[n("p",null,[n("strong",null,"Keyed items:"),s(" Can you make a component that re-renders its content whenever a special "),n("code",{class:""},"key"),s(" signal changes? This might be useful for the \u201CEfficient lists\u201D item.")])]),n("li",null,[n("p",null,[n("strong",null,"Awaiting data:"),s(" Try to make a component that can render a pending, completed, or failed view based on the state of a Promise. Take inspiration from Svelte\u2019s {#await} block; it\u2019s a great implementation.")])]),n("li",null,[n("p",null,[n("strong",null,"Template syntax:"),s(" If you\u2019re up for a challenge, try making a tool to convert Svelte or Vue syntax (or another template language) into our code, once you\u2019ve finished the challenges above.")])])]),n("p",null,"Thanks for reading this blog article on zSnout! Stay tuned for next time, where we\u2019ll be extending Pascal\u2019s Triangle into negative and complex numbers.")],-1),k=n("nav",null,[n("ul",null,[n("li",null,[n("a",{href:"#prerequisites"},"Prerequisites")]),n("li",null,[n("a",{href:"#the-reactive-primitives"},"The reactive primitives")]),n("li",null,[n("a",{href:"#values-and-memos"},"Values and memos")]),n("li",null,[n("a",{href:"#making-a-render-function"},"Making a render function")]),n("li",null,[n("a",{href:"#bonus-features"},"Bonus features")]),n("li",null,[n("a",{href:"#measuring-performance"},"Measuring performance")]),n("li",null,[n("a",{href:"#conclusion"},"Conclusion")])])],-1),i={author:"Zachary Sakowitz",category:"code",date:16686432e5,hasToc:!0},w="",m=e({__name:"yet-another-web-framework",setup(r,{expose:t}){return t({frontmatter:{author:"Zachary Sakowitz",category:"code",date:16686432e5,hasToc:!0},excerpt:void 0}),(d,f)=>{const o=u("prose");return c(),p(o,{frontmatter:i},{aside:a(()=>[k]),default:a(()=>[l]),_:1})}}});export{m as default,w as excerpt,i as frontmatter};

import{u as P,a as R}from"./useVideoFromStream.76445653.js";import{u as j}from"./useCanvas.01897302.js";import{d as E,k as p,_ as L,o as O,c as T,w,a as x}from"./index.3fd24dee.js";import{F as U}from"./FullscreenDisplay.7b04f428.js";import"./BookmarkIcon.2ba3923d.js";function V(r){const c=document.createElement("canvas"),h=c.getContext("2d");return{canvas:c,ctx:h,update:(n=r.videoWidth,o=r.videoHeight)=>{c.width=n,c.height=o,h.drawImage(r,0,0,n,o)}}}const Q=E({__name:"AsciiArt",setup(r){const n="$@B%8&WM#*oahkbdpqwmZO0QLCJUYXzcvunxrjft/\\|()1{}[]?-_+~<>i!lI;:,\"^`'.  ",o=p(),l=p("user"),{stream:u,setOpts:b}=P({audio:!1,video:{facingMode:{ideal:l.value}}});function M(){l.value=l.value==="user"?"environment":"user",b({audio:!1,video:{facingMode:{ideal:l.value}}})}const _=R(u,!0),{ctx:d,update:z}=V(_);return j(o,{useDevicePixelRatio:!1}).then(f=>{const{canvas:i}=f,e=i.getContext("2d");if(!e)throw new Error("Your device doesn't support HTML5 canvases.");L(()=>{if(!u.value)return;z(~~(i.width/7.5),~~(i.height/9));const t=d.getImageData(0,0,d.canvas.width,d.canvas.height);e.beginPath(),e.fillStyle="black",e.fillRect(0,0,i.width,i.height);for(let a=0;a<t.height;a++)for(let s=0;s<t.width;s++){const[m,v,g]=t.data.subarray(4*(a*t.width+s),4*(a*t.width+s)+3),[C,y,k]=t.data.subarray(4*(a*t.width+Math.max(0,s-1)),4*(a*t.width+Math.max(0,s-1))+3),[H,W,B]=t.data.subarray(4*(Math.max(0,a-1)*t.width+s),4*(Math.max(0,a-1)*t.width+s)+3),F=(Math.abs(m-C)+Math.abs(m-H))/2,S=(Math.abs(v-y)+Math.abs(v-W))/2,A=(Math.abs(g-k)+Math.abs(g-B))/2,D=.2126*F+.7152*S+.0722*A,I=n[n.length-1-~~(D*n.length/256)];e.beginPath(),e.fillStyle="white",e.font=`${9}px monospace`,e.textAlign="center",e.textBaseline="middle",e.fillText(I,s*7.5+7.5/2,a*9+9/2)}})}),(f,i)=>(O(),T(U,null,{indicator:w(()=>[x("span",{style:{cursor:"pointer"},onClick:M},"Switch Camera")]),default:w(()=>[x("canvas",{ref_key:"canvas",ref:o},null,512)]),_:1}))}});export{Q as default};

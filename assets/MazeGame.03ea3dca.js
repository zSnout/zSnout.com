import{d as S,k,a0 as A,B as F,o as H,c as L,w as Y,a as x}from"./index.a72ff2fb.js";import{F as G}from"./FullscreenDisplay.01d2b06a.js";import{u as E}from"./useCanvas.59cae876.js";import"./BookmarkIcon.701950e0.js";function P(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function _(e){for(var n=1;n<arguments.length;n++){var r=arguments[n]!=null?arguments[n]:{};n%2?P(Object(r),!0).forEach(function(a){N(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function N(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function T(e){return e.slice(0,-1)}function M(e,n=0){return n?Array.from(Array(n-e).keys()).map(r=>r+e):Array.from(Array(e).keys())}function R(e){return[...new Set(e)]}function z(e,n){const r=R(e.map(f=>f.set)).filter(Boolean),a=(i=M(1,e.length+1),o=r,[i,o].reduce((f,s)=>f.filter(h=>!s.includes(h)))).sort(()=>.5-n());var i,o;e.filter(f=>!f.set).forEach((f,s)=>f.set=a[s])}function D(e,n,r=.5){T(e).forEach((a,i)=>{const o=e[i+1],f=a.set!==o.set,s=n()<=r;f&&s&&(function(h,t,c){h.forEach(m=>{m.set===t&&(m.set=c)})}(e,o.set,a.set),a.right=!1,o.left=!1)})}function V(e=8,n=e,r=!0,a=1){const i=function(t){return function(){let c=t+=1831565813;return c=Math.imul(c^c>>>15,1|c),c^=c+Math.imul(c^c>>>7,61|c),((c^c>>>14)>>>0)/4294967296}}(a),o=[],f=M(e);for(let t=0;t<n;t+=1){const c=f.map(m=>({x:m,y:t,top:r||t>0,left:r||m>0,bottom:r||t<n-1,right:r||m<e-1}));o.push(c)}T(o).forEach((t,c)=>{z(t,i),D(t,i),function(m,g,l){const p=Object.values(function(d,v){let u=R(d.map(y=>y.set)).reduce((y,b)=>_(_({},y),{},{[b]:[]}),{});return d.forEach(y=>u[y.set].push(y)),u}(m)),{ceil:B}=Math;p.forEach(d=>{(function(v,u,y){u=u==null?1:u;const b=v==null?0:v.length;if(!b||u<1)return[];u=u>b?b:u;let w=-1;const C=b-1,O=[...v];for(;++w<u;){const j=w+Math.floor(y()*(C-w+1)),I=O[j];O[j]=O[w],O[w]=I}return O.slice(0,u)})(d,B(l()*d.length),l).forEach(v=>{if(v){const u=g[v.x];v.bottom=!1,u.top=!1,u.set=v.set}})})}(t,o[c+1],i)});const s=(h=o)[h.length-1];var h;return z(s,i),D(s,i,1),o}const U=S({__name:"MazeGame",setup(e){const n=k(),r=k(),a=k();let i;const o=24;return E(n,{useDevicePixelRatio:!1}).then(f=>{const{canvas:s,onResize:h}=f,t=s.getContext("2d");if(!t)throw new Error("Your device does not support HTML5 canvases.");function c(){!a.value&&s.width>96&&s.height>96&&(a.value=V(~~(s.width/24)-2,~~(s.height/24)-2))}c(),a.value||h(c),A(()=>{!i||t.putImageData(i,0,0)})}),E(r,{useDevicePixelRatio:!1}).then(f=>{const{canvas:s,onResize:h}=f,t=s.getContext("2d");if(!t)throw new Error("Your device does not support HTML5 canvases.");function c(){if(t.fillStyle="white",t.fillRect(0,0,s.width,s.height),!!a.value){for(const m of a.value)for(const g of m){t.fillStyle="black";const l=g.x*o+o,p=g.y*o+o;g.top&&(t.moveTo(l,p),t.lineTo(l+o,p),t.stroke()),g.left&&(t.moveTo(l,p),t.lineTo(l,p+o),t.stroke()),g.right&&(t.moveTo(l+o,p),t.lineTo(l+o,p+o),t.stroke()),g.bottom&&(t.moveTo(l,p+o),t.lineTo(l+o,p+o),t.stroke())}i=t.getImageData(0,0,s.width,s.height)}}c(),h(c),F(a,c)}),(f,s)=>(H(),L(G,null,{default:Y(()=>[x("canvas",{ref_key:"mazeImage",ref:r},null,512),x("canvas",{ref_key:"canvas",ref:n},null,512)]),_:1}))}});export{U as default};

const o={"+":2,"-":2,"*":3,"#":3,"/":3,"**":4,"^":5,"^2":5,"^3":5};function u(s){return s==="("?0:o[s]||1}const m={"+":"l","-":"l","*":"l","#":"l","/":"l"};function g(s){return m[s]||"r"}const z=["+","-","*","#","/","^","("];function n(s){return!z.includes(s)}function $(s){s=s.toLowerCase();const f=[];let l=!1;for(;;){let p;if(s.length===0)break;s[0]==="$"||s[0]==="@"?s=s.slice(1):(p=s.match(/^\d+(?:\.\d+)?/))||!l&&(p=s.match(/^-\d+(?:\.\d+)?/))?(l&&f.push("**"),l=!0,f.push(+p[0]),s=s.slice(p[0].length)):(p=s.match(/^(sin|cos|tan|exp|log|abs|min|max)/))?(l&&f.push("**"),l=!1,f.push(p[0]),s=s.slice(p[0].length)):(p=s.match(/^(pi|pz|ppz|sz|e|i|c|z|m|t|fx|fy)/))?(l&&f.push("**"),l=!0,f.push(p[0]),s=s.slice(p[0].length)):(p=s.match(/^\.[xy]/))||(p=s.match(/^\^[23]/))?(l=!0,f.push(p[0]),s=s.slice(p[0].length)):((p=s.match(/^[-+*#\/^()]/))&&(l&&p[0]==="("&&f.push("**"),l=!1,p[0]===")"&&(l=!0),f.push(p[0])),s=s.slice(1))}const e=[],t=[];let c;for(;c=f.shift();)if(typeof c=="number"||c.match(/^(pi|pz|ppz|sz|e|i|c|z|fx|fy)$/))e.push(c);else if(c.match(/^\.[xy]$/))e.push(c);else if(c===")"){for(;t[t.length-1]!=="(";){const h=t[t.length-1];if(!h)return["z"];t.pop(),e.push(h)}if(t.pop()!=="(")return["z"];const p=t[t.length-1];if(!p)continue;n(p)&&(t.pop(),e.push(p))}else if(c==="("||n(c))t.push(c);else{const p=c;let h;for(;(h=t[t.length-1])&&h!=="(";){const i=u(p),r=u(h);if(!(r>i||i===r&&g(p)==="l"))break;e.push((t.pop(),h))}t.push(p)}for(;c=t.pop();){if(c==="("||c===")")return["z"];e.push(c)}return e}function v(s){var f;try{const l=[];for(let e of s)if(typeof e=="number")l.push(`vec2(${e}, 0)`);else if(e==="i")l.push("vec2(0, 1)");else if(e==="pi")l.push("vec2(3.141592653589793, 0)");else if(e==="e")l.push("vec2(2.718281828459045, 0)");else if(e==="t")l.push("vec2(time, 0)");else if(e==="m")l.push("mouse");else if(e==="fx")l.push("vec2(1, -1)");else if(e==="fy")l.push("vec2(-1, 1)");else if(e.match(/^(pz|ppz|sz|c|z)$/))l.push(e);else if(e==="+"||e==="-"||e==="#"){const t=l.pop(),c=(f=l.pop())!=null?f:"";l.push(`${c} ${e==="#"?"*":e} ${t}`)}else if(e==="^2")l.push(`sqr(${l.pop()})`);else if(e==="^3")l.push(`cube(${l.pop()})`);else if(e==="*"||e==="**"||e==="/"||e==="^"||e==="min"||e==="max"){e==="/"?e="div":e==="^"?e="power":(e==="*"||e==="**")&&(e="mult");const t=l.pop(),c=l.pop();l.push(`${e}(${c}, ${t})`)}else e==="sin"||e==="cos"||e==="tan"||e==="exp"||e==="log"||e==="abs"?l.push(`${e}(${l.pop()})`):(e===".x"||e===".y")&&l.push(`vec2((${l.pop()})${e}, 0)`);return l.length!==1?"z":l[0]}catch{return"z"}}function x(s){return v($(s))}Object.assign(window,{glsl:x});export{x as g};

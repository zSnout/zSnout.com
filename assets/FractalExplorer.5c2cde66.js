import{d as _,o as p,h as V,s as L,c as z,a as d,p as A,j as G,b,as as Y,e as s,g as M,v as j,at as D,m as v,au as Z,f as U,i as K,q as R}from"./index.c98e82e1.js";import{_ as y,B as E,H as J}from"./Modal.b07c2b2b.js";import{F as ee}from"./Field.69f47312.js";import{F as te}from"./useWebGL.36810a7a.js";import{s as h,u as le}from"./useMovableCanvas.4b98ab97.js";const ne=["value"],ae=_({__name:"Dropdown",props:{modelValue:null},emits:["update:modelValue"],setup(e){return(l,t)=>(p(),V("select",{class:"field focusline second-layer",value:l.$props.modelValue,onChange:t[0]||(t[0]=a=>l.$emit("update:modelValue",a.target.value))},[L(l.$slots,"default",{},void 0,!0)],40,ne))}});var oe=y(ae,[["__scopeId","data-v-7132250d"]]);const N=_({__name:"IconButton",setup(e){return(l,t)=>(p(),z(E,{center:"",style:{width:"2.5em",height:"2.25em"}},{default:d(()=>[L(l.$slots,"default")]),_:3}))}});const ie={},se=e=>(A("data-v-0298e8c4"),e=e(),G(),e),ue={class:"icon",viewBox:"0 0 485.064 485.064",xmlns:"http://www.w3.org/2000/svg"},re=se(()=>b("path",{d:`M458.736,181.097H26.334C11.793,181.097,0,192.884,0,207.425v70.215c0,14.541,11.787,26.328,26.334,26.328h432.402\r
      c14.541,0,26.328-11.787,26.328-26.328v-70.215C485.07,192.884,473.283,181.097,458.736,181.097z`},null,-1)),de=[re];function ce(e,l){return p(),V("svg",ue,de)}var pe=y(ie,[["render",ce],["__scopeId","data-v-0298e8c4"]]);const me={},fe=e=>(A("data-v-079820ed"),e=e(),G(),e),ve={class:"icon",viewBox:"0 0 60.364 60.364",xmlns:"http://www.w3.org/2000/svg"},he=fe(()=>b("path",{d:`M54.454,23.18l-18.609-0.002L35.844,5.91C35.845,2.646,33.198,0,29.934,0c-3.263,0-5.909,2.646-5.909,5.91v17.269\r
		L5.91,23.178C2.646,23.179,0,25.825,0,29.088c0.002,3.264,2.646,5.909,5.91,5.909h18.115v19.457c0,3.267,2.646,5.91,5.91,5.91\r
		c3.264,0,5.909-2.646,5.91-5.908V34.997h18.611c3.262,0,5.908-2.645,5.908-5.907C60.367,25.824,57.718,23.178,54.454,23.18z`},null,-1)),_e=[he];function be(e,l){return p(),V("svg",ve,_e)}var ye=y(me,[["render",be],["__scopeId","data-v-079820ed"]]);const xe=["autocomplete","placeholder","type","value"],ze=_({__name:"InlineField",props:{modelValue:null,type:null,autocomplete:null,placeholder:null},emits:["update:modelValue"],setup(e){return(l,t)=>{var a,n;return p(),V("input",{class:"field",autocomplete:(a=e.autocomplete)!=null?a:"off",placeholder:e.placeholder,style:Y({width:e.modelValue.length+2+"ch"}),type:(n=e.type)!=null?n:"text",value:e.modelValue,onInput:t[0]||(t[0]=u=>l.$emit("update:modelValue",u.target.value))},null,44,xe)}}});var Ve=y(ze,[["__scopeId","data-v-3d0155ac"]]);const ge=_({__name:"InlineNumericField",props:{modelValue:null,autocomplete:null,placeholder:null},emits:["update:modelValue"],setup(e){return(l,t)=>(p(),z(Ve,{autocomplete:e.autocomplete,"model-value":""+e.modelValue,placeholder:e.placeholder,type:"number","onUpdate:modelValue":t[0]||(t[0]=a=>l.$emit("update:modelValue",+a))},null,8,["autocomplete","model-value","placeholder"]))}});const we=_({__name:"Incrementable",props:{modelValue:null,decrement:{type:Function,default:e=>e-1},increment:{type:Function,default:e=>e+1},label:null},emits:["update:modelValue"],setup(e){function l({target:t}){var a;(a=t.querySelector("input"))==null||a.focus()}return(t,a)=>(p(),z(J,null,{default:d(()=>[s(N,{onClick:a[0]||(a[0]=n=>t.$emit("update:modelValue",e.decrement(e.modelValue)))},{default:d(()=>[s(pe)]),_:1}),b("p",{class:"label",onClick:l},[M(j(e.label)+" ",1),s(ge,{"model-value":e.modelValue,"onUpdate:modelValue":a[1]||(a[1]=n=>t.$emit("update:modelValue",n))},null,8,["model-value"])]),s(N,{onClick:a[2]||(a[2]=n=>t.$emit("update:modelValue",e.increment(e.modelValue)))},{default:d(()=>[s(ye)]),_:1})]),_:1}))}});var q=y(we,[["__scopeId","data-v-6b56d56b"]]);const ke=["autocomplete","checked","type"],$e=_({__name:"InlineCheckboxField",props:{modelValue:{type:Boolean},type:null,autocomplete:null},emits:["update:modelValue"],setup(e){return(l,t)=>{var a,n;return p(),V("input",{class:"field",autocomplete:(a=e.autocomplete)!=null?a:"off",checked:e.modelValue,type:(n=e.type)!=null?n:"checkbox",onChange:t[0]||(t[0]=u=>l.$emit("update:modelValue",u.target.checked))},null,40,ke)}}});var T=y($e,[["__scopeId","data-v-5a55106d"]]);const Ie=["autocomplete","max","min","step","value"],Ce=_({__name:"InlineRangeField",props:{modelValue:null,autocomplete:null,min:null,max:null,step:null},emits:["update:modelValue"],setup(e){return(l,t)=>{var a;return p(),V("input",{class:"field",autocomplete:(a=e.autocomplete)!=null?a:"off",max:e.max,min:e.min,step:e.step,value:e.modelValue,type:"range",onInput:t[0]||(t[0]=n=>l.$emit("update:modelValue",+n.target.value))},null,40,Ie)}}});var P=y(Ce,[["__scopeId","data-v-13b05489"]]);const Fe={class:"label"},Ue={class:"nowrap"},Se=_({__name:"Labeled",props:{label:null},setup(e){return(l,t)=>(p(),V("label",Fe,[s(J,null,{default:d(()=>[b("span",Ue,j(e.label),1),L(l.$slots,"default",{},void 0,!0)]),_:3})]))}});var x=y(Se,[["__scopeId","data-v-c154c8f4"]]);let Re={"+":2,"-":2,"*":3,"/":3,"**":4,"^":5};function H(e){return e=="("?0:Re[e]||1}let Pe={"+":"l","-":"l","*":"l","/":"l"};function Ee(e){return Pe[e]||"r"}let Le=["+","-","*","/","^","("];function Q(e){return!Le.includes(e)}function Me(e){let l=[],t=!1;for(;;){let i;if(e.length===0)break;(i=e.match(/^\d+(?:\.\d+)?/))?(t&&l.push("**"),t=!0,l.push(+i[0]),e=e.slice(i[0].length)):(i=e.match(/^(sin|cos|tan|exp|log|abs|min|max|rawsqr)/))?(t&&l.push("**"),t=!1,l.push(i[0]),e=e.slice(i[0].length)):(i=e.match(/^(pi|pz|ppz|sz|e|i|c|z)/))?(t&&l.push("**"),t=!0,l.push(i[0]),e=e.slice(i[0].length)):((i=e.match(/^[-+*\/^()]/))&&(t&&i[0]=="("&&l.push("**"),t=!1,i[0]==")"&&(t=!0),l.push(i[0])),e=e.slice(1))}let a=[],n=[],u;for(;u=l.shift();)if(typeof u=="number"||u.match(/^(pi|pz|ppz|sz|e|i|c|z)$/))a.push(u);else if(u==")"){for(;n[n.length-1]!="(";){let m=n[n.length-1];if(!m)return["z"];n.pop(),a.push(m)}if(n.pop()!="(")return["z"];let i=n[n.length-1];if(!i)continue;Q(i)&&(n.pop(),a.push(i))}else if(u=="("||Q(u))n.push(u);else{let i=u,m;for(;(m=n[n.length-1])&&m!="(";){let f=H(i),g=H(m);if(!(g>f||f==g&&Ee(i)=="l"))break;a.push((n.pop(),m))}n.push(i)}for(;u=n.pop();){if(u=="("||u==")")return["z"];a.push(u)}return a}function Oe(e){try{let l=[];for(let t of e)if(typeof t=="number")l.push(`vec2(${t}, 0)`);else if(t=="i")l.push("vec2(0, 1)");else if(t=="pi")l.push("vec2(3.141592653589793, 0)");else if(t=="e")l.push("vec2(2.718281828459045, 0)");else if(t.match(/^(pz|ppz|sz|c|z)$/))l.push(t);else if(t=="+"||t=="-"){let a=l.pop(),n=l.pop();l.push(`${n} ${t} ${a}`)}else if(t=="*"||t=="**"||t=="/"||t=="^"||t=="min"||t=="max"){t=="/"?t="div":t=="^"?t="power":(t=="*"||t=="**")&&(t="mult");let a=l.pop(),n=l.pop();l.push(`${t}(${n}, ${a})`)}else(t=="sin"||t=="cos"||t=="tan"||t=="exp"||t=="log"||t=="abs"||t=="rawsqr")&&l.push(`${t}(${l.pop()})`);return l.length!=1?"z":l[0]}catch{return"z"}}function Be(e){return Oe(Me(e))}const De=M("Apply Equation"),Ke=b("option",{value:"simple"},"Simple",-1),Ne=b("option",{value:"gradient"},"Gradient",-1),qe=b("option",{value:"newton"},"Newton's Method",-1),Te=M(" Reset Position "),Je=_({__name:"FractalExplorer",setup(e){const l=D(100,5,1/0);h("detail",l);function t(o){return o<=10?5:o<=25?5*Math.ceil((o-5)/5):o<=50?25:50*Math.ceil((o-50)/50)}function a(o){return o<10?10:o<25?5*~~((o+5)/5):o<50?50:50*~~((o+50)/50)}const n=D(2,.1,1/0);h("limit",n);function u(o){return o<=2?Math.ceil(10*(o-.1))/10:Math.ceil(o-1)}function i(o){return o<2?~~(10*(o+.1))/10:~~(o+1)}const m=v("z^2+c");h("equation",m);const f=v("simple");h("theme",f);const g={simple:1,gradient:2,newton:3},W=Z(()=>g[f.value]),w=v(0);h("colorOffset",w);const k=v(1);h("colorRepetition",k);const $=v(1);h("spectrum",$);const I=v(!1);h("darkness",I);const C=v(!1);h("split",C);const X="in vec2 pos;out vec4 color;uniform int detail;uniform float limit;uniform int theme;uniform float colorOffset;uniform float colorRepetition;uniform float spectrum;uniform bool darkness;uniform bool split;float pi=3.1415926535;vec3 rgb2hsv(vec3 c){vec4 K=vec4(0.0,-1.0/3.0,2.0/3.0,-1.0);vec4 p=mix(vec4(c.bg,K.wz),vec4(c.gb,K.xy),step(c.b,c.g));vec4 q=mix(vec4(p.xyw,c.r),vec4(c.r,p.yzx),step(p.x,c.r));float d=q.x-min(q.w,q.y);float e=1.0e-10;return vec3(abs(q.z+(q.w-q.y)/(6.0*d+e)),d/(q.x+e),q.x);}vec3 hsv2rgb(vec3 c){vec4 K=vec4(1.0,2.0/3.0,1.0/3.0,3.0);vec3 p=abs(fract(c.xxx+K.xyz)*6.0-K.www);return c.z*mix(K.xxx,clamp(p-K.xxx,0.0,1.0),c.y);}vec3 simplePalette(int i){float hue=mod(0.02*colorRepetition*float(i),1.0);vec3 hsv=vec3(1.0-hue*spectrum,1,1);if(darkness)hsv.z=mod(0.02*float(i),1.0);hsv.x=mod(hsv.x+colorOffset,1.0);return hsv2rgb(hsv);}vec3 gradientPalette(vec3 sz,int i){sz=abs(sz)/float(i)*colorRepetition;vec3 hsv=rgb2hsv(sin(abs(sz*5.0))*0.45+0.5);vec3 rgb=hsv2rgb(vec3(hsv.x*spectrum+colorOffset,hsv.yz));if(darkness)rgb*=mod(float(i)*0.02,1.0);return rgb;}vec3 newtonPalette(float t){float hue=mod(t/pi,1.0)*spectrum;hue=mod(hue+colorOffset,1.0);return hsv2rgb(vec3(1.0-hue,1,1));}vec2 cube(vec2 a){float x2=a.x*a.x;float y2=a.y*a.y;float d=x2-y2;return vec2(a.x*(d-y2-y2),a.y*(d+x2+x2));}vec2 sqr(vec2 a){return vec2(a.x*a.x-a.y*a.y,2.0*a.x*a.y);}vec2 rawsqr(vec2 a){return a*a;}vec2 mult(vec2 a,vec2 b){float x=a.x*b.x-a.y*b.y;float y=a.x*b.y+a.y*b.x;return vec2(x,y);}vec2 div(vec2 a,vec2 b){float denom=1.0/(b.x*b.x+b.y*b.y);return vec2(a.x*b.x+a.y*b.y,a.y*b.x-a.x*b.y)*denom;}vec2 power(vec2 a,vec2 b){int count=int(b.x);if(count<=1)return a;vec2 result=a;for(int i=1;i<count;i++){result=mult(result,a);}return result;}void main(){vec2 pz,ppz,nz,c=pos,z;vec3 sz;if(theme==1||theme==3)z=pos;int iter=0;for(int i=0;i<detail;i++){ppz=pz;pz=z;z={{EQ}};iter++;if(theme==1&&length(z)>limit){color=vec4(simplePalette(iter),1);return;}if(theme==2&&length(z)>limit){color=vec4(gradientPalette(sz,iter),1);return;}nz+=z;sz.x+=dot(z-pz,pz-ppz);sz.y+=dot(z-pz,z-pz);sz.z+=dot(z-ppz,z-ppz);if(split){sz+=sign(vec3(float(z),float(pz),float(ppz)));}}if(theme==2){color=vec4(gradientPalette(sz,iter),1);}else if(theme==3){if(darkness)z=nz;color=vec4(newtonPalette(atan(z.y/z.x)),1);}else color=vec4(0,0,0,1);}",O=v();let F,S=v();function B(){F==null||F(),le(O,X.replace("{{EQ}}",Be(m.value))).then(o=>{o.useUniform("detail","i",l),o.useUniform("limit","f",n),o.useUniform("theme","i",W),o.useUniform("colorOffset","f",w),o.useUniform("colorRepetition","f",k),o.useUniform("spectrum","f",$),o.useUniform("darkness","f",I),o.useUniform("split","f",C),F=o.destroy,S.value=()=>{o.bounds.xStart.value=-2,o.bounds.xEnd.value=2,o.bounds.yStart.value=-2,o.bounds.yEnd.value=2}})}return B(),(o,r)=>(p(),z(te,null,{options:d(()=>[s(q,{modelValue:U(l),"onUpdate:modelValue":r[0]||(r[0]=c=>K(l)?l.value=c:null),decrement:t,increment:a,label:"Detail Level:"},null,8,["modelValue"]),s(q,{modelValue:U(n),"onUpdate:modelValue":r[1]||(r[1]=c=>K(n)?n.value=c:null),decrement:u,increment:i,label:"Fractal Size:"},null,8,["modelValue"]),s(x,{label:"Equation:"},{default:d(()=>[s(ee,{modelValue:m.value,"onUpdate:modelValue":r[2]||(r[2]=c=>m.value=c)},null,8,["modelValue"]),s(E,{style:{"white-space":"pre"},onClick:B},{default:d(()=>[De]),_:1})]),_:1}),s(x,{label:"Theme:"},{default:d(()=>[s(oe,{modelValue:f.value,"onUpdate:modelValue":r[3]||(r[3]=c=>f.value=c)},{default:d(()=>[Ke,Ne,qe]),_:1},8,["modelValue"])]),_:1}),s(x,{label:"Color Offset:"},{default:d(()=>[s(P,{modelValue:w.value,"onUpdate:modelValue":r[4]||(r[4]=c=>w.value=c),max:1,min:0,step:"any"},null,8,["modelValue"])]),_:1}),f.value!="newton"?(p(),z(x,{key:0,label:"Color Repetition:"},{default:d(()=>[s(P,{modelValue:k.value,"onUpdate:modelValue":r[5]||(r[5]=c=>k.value=c),max:f.value==="gradient"?5:10,min:f.value==="gradient"?0:-10,step:"any"},null,8,["modelValue","max","min"])]),_:1})):R("",!0),s(x,{label:"Color Spectrum:"},{default:d(()=>[s(P,{modelValue:$.value,"onUpdate:modelValue":r[6]||(r[6]=c=>$.value=c),max:1,min:0,step:"any"},null,8,["modelValue"])]),_:1}),s(x,{label:f.value==="newton"?"3D Effect?":"Darkness Effect?"},{default:d(()=>[s(T,{modelValue:I.value,"onUpdate:modelValue":r[7]||(r[7]=c=>I.value=c)},null,8,["modelValue"])]),_:1},8,["label"]),f.value==="gradient"?(p(),z(x,{key:1,label:"Split Effect?"},{default:d(()=>[s(T,{modelValue:C.value,"onUpdate:modelValue":r[8]||(r[8]=c=>C.value=c)},null,8,["modelValue"])]),_:1})):R("",!0)]),buttons:d(()=>[U(S)?(p(),z(E,{key:0,onClick:U(S)},{default:d(()=>[Te]),_:1},8,["onClick"])):R("",!0)]),default:d(()=>[b("canvas",{ref_key:"canvas",ref:O},null,512)]),_:1}))}});export{Je as default};

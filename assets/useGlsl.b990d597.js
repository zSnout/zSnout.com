const r={"+":2,"-":2,"*":3,"#":3,"/":3,"**":4,"^":5};function o(t){return t==="("?0:r[t]||1}const z={"+":"l","-":"l","*":"l","#":"l","/":"l"};function a(t){return z[t]||"r"}const g=["+","-","*","#","/","^","("];function u(t){return!g.includes(t)}function m(t){const f=[];let s=!1;for(;;){let p;if(t.length===0)break;(p=t.match(/^\d+(?:\.\d+)?/))?(s&&f.push("**"),s=!0,f.push(+p[0]),t=t.slice(p[0].length)):(p=t.match(/^(sin|cos|tan|exp|log|abs|min|max)/))?(s&&f.push("**"),s=!1,f.push(p[0]),t=t.slice(p[0].length)):(p=t.match(/^(pi|pz|ppz|sz|e|i|c|z|fx|fy)/))?(s&&f.push("**"),s=!0,f.push(p[0]),t=t.slice(p[0].length)):((p=t.match(/^[-+*#\/^()]/))&&(s&&p[0]==="("&&f.push("**"),s=!1,p[0]===")"&&(s=!0),f.push(p[0])),t=t.slice(1))}const e=[],l=[];let c;for(;c=f.shift();)if(typeof c=="number"||c.match(/^(pi|pz|ppz|sz|e|i|c|z|fx|fy)$/))e.push(c);else if(c===")"){for(;l[l.length-1]!=="(";){const n=l[l.length-1];if(!n)return["z"];l.pop(),e.push(n)}if(l.pop()!=="(")return["z"];const p=l[l.length-1];if(!p)continue;u(p)&&(l.pop(),e.push(p))}else if(c==="("||u(c))l.push(c);else{const p=c;let n;for(;(n=l[l.length-1])&&n!=="(";){const i=o(p),h=o(n);if(!(h>i||i===h&&a(p)==="l"))break;e.push((l.pop(),n))}l.push(p)}for(;c=l.pop();){if(c==="("||c===")")return["z"];e.push(c)}return e}function v(t){var f;try{const s=[];for(let e of t)if(typeof e=="number")s.push(`vec2(${e}, 0)`);else if(e==="i")s.push("vec2(0, 1)");else if(e==="pi")s.push("vec2(3.141592653589793, 0)");else if(e==="e")s.push("vec2(2.718281828459045, 0)");else if(e==="fx")s.push("vec2(1, -1)");else if(e==="fy")s.push("vec2(-1, 1)");else if(e.match(/^(pz|ppz|sz|c|z)$/))s.push(e);else if(e==="+"||e==="-"||e==="#"){const l=s.pop(),c=(f=s.pop())!=null?f:"";s.push(`${c} ${e==="#"?"*":e} ${l}`)}else if(e==="*"||e==="**"||e==="/"||e==="^"||e==="min"||e==="max"){e==="/"?e="div":e==="^"?e="power":(e==="*"||e==="**")&&(e="mult");const l=s.pop(),c=s.pop();s.push(`${e}(${c}, ${l})`)}else(e==="sin"||e==="cos"||e==="tan"||e==="exp"||e==="log"||e==="abs")&&s.push(`${e}(${s.pop()})`);return s.length!==1?"z":s[0]}catch{return"z"}}function $(t){return v(m(t))}Object.assign(window,{glsl:$});export{$ as g};
